var jt=Object.defineProperty,Et=Object.defineProperties;var Gt=Object.getOwnPropertyDescriptors;var ot=Object.getOwnPropertySymbols;var At=Object.prototype.hasOwnProperty,Lt=Object.prototype.propertyIsEnumerable;var Xe=(s,e,o)=>e in s?jt(s,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):s[e]=o,fe=(s,e)=>{for(var o in e||(e={}))At.call(e,o)&&Xe(s,o,e[o]);if(ot)for(var o of ot(e))Lt.call(e,o)&&Xe(s,o,e[o]);return s},ke=(s,e)=>Et(s,Gt(e));var F=(s,e,o)=>(Xe(s,typeof e!="symbol"?e+"":e,o),o);var rt=(s,e,o)=>new Promise((r,a)=>{var n=i=>{try{c(o.next(i))}catch(f){a(f)}},l=i=>{try{c(o.throw(i))}catch(f){a(f)}},c=i=>i.done?r(i.value):Promise.resolve(i.value).then(n,l);c((o=o.apply(s,e)).next())});import{r as p,a as zt,R as Bt}from"./vendor-1.1.0-1f763956.js";import{W as Ot,q as _t}from"./helmet-1.1.0-341783ac.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const n of a)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function o(a){const n={};return a.integrity&&(n.integrity=a.integrity),a.referrerPolicy&&(n.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?n.credentials="include":a.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(a){if(a.ep)return;a.ep=!0;const n=o(a);fetch(a.href,n)}})();var bt={exports:{}},Fe={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nt=p,$t=Symbol.for("react.element"),It=Symbol.for("react.fragment"),Dt=Object.prototype.hasOwnProperty,Ft=Nt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ht={key:!0,ref:!0,__self:!0,__source:!0};function wt(s,e,o){var r,a={},n=null,l=null;o!==void 0&&(n=""+o),e.key!==void 0&&(n=""+e.key),e.ref!==void 0&&(l=e.ref);for(r in e)Dt.call(e,r)&&!Ht.hasOwnProperty(r)&&(a[r]=e[r]);if(s&&s.defaultProps)for(r in e=s.defaultProps,e)a[r]===void 0&&(a[r]=e[r]);return{$$typeof:$t,type:s,key:n,ref:l,props:a,_owner:Ft.current}}Fe.Fragment=It;Fe.jsx=wt;Fe.jsxs=wt;bt.exports=Fe;var u=bt.exports,Ke={},st=zt;Ke.createRoot=st.createRoot,Ke.hydrateRoot=st.hydrateRoot;const Wt="modulepreload",Vt=function(s){return"/ChipPuzzleGame/"+s},nt={},je=function(e,o,r){if(!o||o.length===0)return e();const a=document.getElementsByTagName("link");return Promise.all(o.map(n=>{if(n=Vt(n),n in nt)return;nt[n]=!0;const l=n.endsWith(".css"),c=l?'[rel="stylesheet"]':"";if(!!r)for(let h=a.length-1;h>=0;h--){const b=a[h];if(b.href===n&&(!l||b.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${n}"]${c}`))return;const f=document.createElement("link");if(f.rel=l?"stylesheet":Wt,l||(f.as="script",f.crossOrigin=""),f.href=n,document.head.appendChild(f),l)return new Promise((h,b)=>{f.addEventListener("load",h),f.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${n}`)))})})).then(()=>e()).catch(n=>{const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=n,window.dispatchEvent(l),!l.defaultPrevented)throw n})};class Ut{constructor(){F(this,"isDevelopment",!1);F(this,"logHistory",[]);F(this,"maxHistorySize",100)}createLogEntry(e,o,r){return{level:e,message:o,data:r,timestamp:new Date().toISOString(),userAgent:typeof navigator!="undefined"?navigator.userAgent:void 0,url:typeof window!="undefined"?window.location.href:void 0}}addToHistory(e){this.logHistory.push(e),this.logHistory.length>this.maxHistorySize&&this.logHistory.shift()}log(e,o,r){const a=this.createLogEntry(e,o,r);if(this.addToHistory(a),this.isDevelopment){const n=console[e]||console.log;r?n(`[${e.toUpperCase()}] ${o}`,r):n(`[${e.toUpperCase()}] ${o}`)}e==="error"&&this.handleError(a)}handleError(e){try{const o=JSON.parse(localStorage.getItem("chipPuzzleGame_errorLogs")||"[]");o.push(e),o.length>50&&o.shift(),localStorage.setItem("chipPuzzleGame_errorLogs",JSON.stringify(o))}catch(o){this.isDevelopment}}debug(e,o){this.log("debug",e,o)}info(e,o){this.log("info",e,o)}warn(e,o){this.log("warn",e,o)}error(e,o){this.log("error",e,o)}getHistory(){return[...this.logHistory]}clearHistory(){this.logHistory=[]}getErrorLogs(){try{return JSON.parse(localStorage.getItem("chipPuzzleGame_errorLogs")||"[]")}catch(e){return[]}}clearErrorLogs(){try{localStorage.removeItem("chipPuzzleGame_errorLogs")}catch(e){}}}const R=new Ut;class Yt extends p.Component{constructor(){super(...arguments);F(this,"state",{hasError:!1,error:null,errorInfo:null});F(this,"handleReload",()=>{window.location.reload()});F(this,"handleReset",()=>{this.setState({hasError:!1,error:null,errorInfo:null})})}static getDerivedStateFromError(o){return{hasError:!0,error:o}}componentDidCatch(o,r){R.error("ErrorBoundary caught an error",{error:{message:o.message,stack:o.stack,name:o.name},errorInfo:{componentStack:r.componentStack},timestamp:new Date().toISOString()}),this.setState({errorInfo:r})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:u.jsx("div",{className:"error-boundary",role:"alert","aria-live":"assertive",children:u.jsxs("div",{className:"error-boundary-content",children:[u.jsx("div",{className:"error-boundary-icon",children:"‚ö†Ô∏è"}),u.jsx("h2",{className:"error-boundary-title",children:this.getLocalizedText("error.title")}),u.jsx("p",{className:"error-boundary-message",children:this.state.error?this.getLocalizedText("error.messageWithDetails",{error:this.state.error.message||this.state.error.name||"Ïïå Ïàò ÏóÜÎäî Ïò§Î•ò"}):this.getLocalizedText("error.message")}),!1,u.jsxs("div",{className:"error-boundary-actions",children:[u.jsx("button",{className:"error-boundary-button error-boundary-button-primary",onClick:this.handleReload,"aria-label":this.getLocalizedText("error.reload"),children:this.getLocalizedText("error.reload")}),!1]})]})}):this.props.children}getLocalizedText(o,r){var c;let a="ko";try{a=localStorage.getItem("language")||"ko"}catch(i){}const n={ko:{"error.title":"Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§","error.message":"Í≤åÏûÑÏùÑ ÏÉàÎ°úÍ≥†Ïπ®Ìï¥Ï£ºÏÑ∏Ïöî.","error.messageWithDetails":"Îã§Ïùå Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§: {error}. Í≤åÏûÑÏùÑ ÏÉàÎ°úÍ≥†Ïπ®Ìï¥Ï£ºÏÑ∏Ïöî.","error.details":"ÏóêÎü¨ ÏÉÅÏÑ∏ Ï†ïÎ≥¥","error.reload":"ÏÉàÎ°úÍ≥†Ïπ®","error.reset":"Îã§Ïãú ÏãúÎèÑ"},en:{"error.title":"An Error Occurred","error.message":"Please refresh the game.","error.details":"Error Details","error.reload":"Reload","error.reset":"Try Again"},zh:{"error.title":"ÂèëÁîüÈîôËØØ","error.message":"ËØ∑Âà∑Êñ∞Ê∏∏Êàè„ÄÇ","error.details":"ÈîôËØØËØ¶ÊÉÖ","error.reload":"ÈáçÊñ∞Âä†ËΩΩ","error.reset":"ÈáçËØï"},ja:{"error.title":"„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü","error.message":"„Ç≤„Éº„É†„Çí„É™„Éï„É¨„ÉÉ„Ç∑„É•„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ","error.details":"„Ç®„É©„ÉºË©≥Á¥∞","error.reload":"„É™„É≠„Éº„Éâ","error.reset":"ÂÜçË©¶Ë°å"}};let l=((c=n[a])==null?void 0:c[o])||n.ko[o]||o;if(r)for(const[i,f]of Object.entries(r))l=l.replace(`{${i}}`,f);return l}}const Xt=(s,e)=>{const o=s[e];return o?typeof o=="function"?o():Promise.resolve(o):new Promise((r,a)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(a.bind(null,new Error("Unknown variable dynamic import: "+e)))})},St=["en","ko","zh","ja"],qt="en",Jt={en:"English",ko:"ÌïúÍµ≠Ïñ¥",zh:"‰∏≠Êñá",ja:"Êó•Êú¨Ë™û"};class at{constructor(){F(this,"supportedLanguages",St);F(this,"defaultLanguage",qt)}detectBrowserLanguage(){const e=navigator.language.split("-")[0];return this.supportedLanguages.includes(e)?e:this.defaultLanguage}getStoredLanguage(){try{return localStorage.getItem("language")}catch(e){return R.error("Failed to get stored language",{error:e}),null}}setLanguage(e){if(this.supportedLanguages.includes(e))try{localStorage.setItem("language",e),window.dispatchEvent(new CustomEvent("languageChanged",{detail:e})),R.debug("Language changed",{language:e})}catch(o){R.error("Failed to set language",{error:o,language:e})}}getCurrentLanguage(){const e=this.getStoredLanguage();return e&&this.supportedLanguages.includes(e)?e:this.detectBrowserLanguage()}}const qe={},Be=()=>{const[s,e]=p.useState(()=>new at().getCurrentLanguage()),[o,r]=p.useState(null),[a,n]=p.useState(!0);return p.useEffect(()=>{(()=>rt(void 0,null,function*(){n(!0);try{if(qe[s]){r(qe[s]),n(!1);return}const h=yield Xt(Object.assign({"../locales/en.json":()=>je(()=>import("./en-1.1.0-4603ac2a.js"),[]),"../locales/ja.json":()=>je(()=>import("./ja-1.1.0-7b36dec0.js"),[]),"../locales/ko.json":()=>je(()=>import("./ko-1.1.0-105299b0.js"),[]),"../locales/zh.json":()=>je(()=>import("./zh-1.1.0-860c5cd6.js"),[])}),`../locales/${s}.json`);qe[s]=h.default,r(h.default),R.debug("Translations loaded",{language:s})}catch(h){R.error("Failed to load translations",{language:s,error:h});try{const b=yield je(()=>import("./en-1.1.0-4603ac2a.js"),[]);r(b.default),R.info("Fallback translations loaded",{language:"en"})}catch(b){R.error("Failed to load fallback translations",{error:b})}}finally{n(!1)}}))();const f=h=>{e(h.detail)};return window.addEventListener("languageChanged",f),()=>{window.removeEventListener("languageChanged",f)}},[s]),{language:s,setLanguage:i=>{new at().setLanguage(i)},t:i=>{if(a||!o)return i;const f=i.split(".");let h=o;for(const b of f)if(h=h==null?void 0:h[b],h===void 0)break;return h||i},isLoading:a}},vt=()=>{const{language:s,setLanguage:e}=Be();return u.jsx("select",{value:s,onChange:o=>e(o.target.value),className:"language-selector","aria-label":"Language selector",children:St.map(o=>u.jsx("option",{value:o,children:Jt[o]},o))})};class Kt{constructor(){F(this,"audioCtx",null);F(this,"enabled",!0)}getContext(){if(!this.enabled)return null;try{if(!this.audioCtx){const e=window.AudioContext||window.webkitAudioContext;if(!e)return R.warn("Web Audio API is not supported in this browser"),this.enabled=!1,null;try{this.audioCtx=new e,this.audioCtx.state==="suspended"&&this.audioCtx.resume().catch(o=>{R.warn("Failed to resume AudioContext",{error:o})})}catch(o){return R.warn("Failed to create AudioContext",{error:o}),this.enabled=!1,null}}return this.audioCtx}catch(e){return R.warn("Failed to initialize AudioContext",{error:e}),this.enabled=!1,null}}setEnabled(e){this.enabled=e}playTone(e,o,r="sine",a=.2){const n=this.getContext();if(!n)return;const l=n.createOscillator(),c=n.createGain();l.type=r,l.frequency.value=e,c.gain.value=a,l.connect(c),c.connect(n.destination);const i=n.currentTime;l.start(i),l.stop(i+o),c.gain.setValueAtTime(a,i),c.gain.linearRampToValueAtTime(0,i+o)}playClick(){this.playTone(440,.08,"square",.15)}playMatch(){this.playTone(660,.12,"triangle",.2)}playSpecial(){this.playTone(880,.16,"sawtooth",.22)}playStageClear(){this.getContext()&&(this.playTone(880,.15,"triangle",.22),setTimeout(()=>{this.playTone(1046.5,.18,"triangle",.22)},120))}playGameOver(){const e=this.getContext();if(!e)return;const o=440,r=220,a=.4,n=e.createOscillator(),l=e.createGain();n.type="sawtooth",n.frequency.setValueAtTime(o,e.currentTime),n.frequency.exponentialRampToValueAtTime(r,e.currentTime+a),l.gain.value=.22,l.gain.setValueAtTime(.22,e.currentTime),l.gain.linearRampToValueAtTime(0,e.currentTime+a),n.connect(l),l.connect(e.destination),n.start(e.currentTime),n.stop(e.currentTime+a)}}const de=new Kt;class Qt{constructor(){F(this,"storage",new Map)}get(e){try{const o=this.storage.get(e);return o===void 0?null:JSON.parse(o)}catch(o){return R.warn("Failed to parse memory storage",{key:e,error:o}),null}}set(e,o){try{const r=JSON.stringify(o);return this.storage.set(e,r),!0}catch(r){return R.error("Failed to set item to memory storage",{key:e,error:r}),!1}}remove(e){return this.storage.delete(e)}clear(){this.storage.clear()}keys(){return Array.from(this.storage.keys())}}const it=new Qt;function lt(s){if(!s||typeof s!="object")return!1;const e=s;if(typeof e.version!="string"||!e.version||!e.progress||typeof e.progress!="object")return!1;const o=e.progress;if(typeof o.highestStage!="number"||o.highestStage<1||!o.stageRecords||typeof o.stageRecords!="object")return!1;const r=o.stageRecords;for(const a in r){const n=r[a];if(!n||typeof n!="object")return!1;const l=n;if(typeof l.stageNumber!="number"||l.stageNumber<1)return!1}if(e.settings!==void 0){if(typeof e.settings!="object"||e.settings===null)return!1;const a=e.settings;if(a.language!==void 0&&typeof a.language!="string"||a.soundEnabled!==void 0&&typeof a.soundEnabled!="boolean")return!1}return!0}function ct(s){if(!s||typeof s!="object")return!1;const e=s;return!(typeof e.highestStage!="number"||e.highestStage<1||e.highestStage>1e3||!e.stageRecords||typeof e.stageRecords!="object")}function Zt(s){if(typeof s!="string")return null;const e=[/<script[^>]*>.*?<\/script>/gi,/javascript:/gi,/on\w+\s*=/gi,/<iframe[^>]*>/gi,/<object[^>]*>/gi,/<embed[^>]*>/gi];let o=s;for(const r of e)o=o.replace(r,"");return o.length>10*1024?null:o}class eo{constructor(){F(this,"useMemoryStorage",!1)}isAvailable(){try{const e="__storage_test__";return localStorage.setItem(e,e),localStorage.removeItem(e),this.useMemoryStorage=!1,!0}catch(e){return this.useMemoryStorage=!0,R.warn("LocalStorage is not available, using memory storage"),!1}}get(e,o={}){var a,n,l,c,i,f,h,b;const r=this.isAvailable();if(!r&&this.useMemoryStorage){const g=it.get(e);return g!==null?g:(a=o.fallback)!=null?a:null}if(!r)return o.silent||R.warn("LocalStorage is not available",{key:e}),(n=o.fallback)!=null?n:null;try{const g=localStorage.getItem(e);if(g===null)return(l=o.fallback)!=null?l:null;let y;try{y=JSON.parse(g)}catch(T){if(typeof g=="string"&&g.startsWith('"')&&g.endsWith('"'))y=JSON.parse(g);else return typeof o.fallback=="string"?g:(localStorage.removeItem(e),o.silent||R.warn("Removed invalid storage data",{key:e,value:g}),(c=o.fallback)!=null?c:null)}if(e.startsWith("chipPuzzleGame_")){if(e==="chipPuzzleGame_progress"){if(!ct(y))return R.warn("Invalid game progress data, removing",{key:e}),localStorage.removeItem(e),(i=o.fallback)!=null?i:null}else if(e==="chipPuzzleGame_data"&&!lt(y))return R.warn("Invalid storage data, removing",{key:e}),localStorage.removeItem(e),(f=o.fallback)!=null?f:null}return y}catch(g){return g instanceof SyntaxError&&o.silent?(h=o.fallback)!=null?h:null:(o.silent||R.error("Failed to get item from LocalStorage",{key:e,error:g}),(b=o.fallback)!=null?b:null)}}set(e,o,r={}){const a=this.isAvailable();if(!a&&this.useMemoryStorage){const n=it.set(e,o);return!n&&!r.silent&&R.warn("Failed to save to memory storage",{key:e}),n}if(!a)return r.silent||R.warn("LocalStorage is not available",{key:e}),!1;try{if(e.startsWith("chipPuzzleGame_")){if(e==="chipPuzzleGame_progress"){if(!ct(o))return R.error("Invalid game progress data, not saving",{key:e,value:o}),!1}else if(e==="chipPuzzleGame_data"&&!lt(o))return R.error("Invalid storage data, not saving",{key:e,value:o}),!1}if(typeof o=="string"){const c=Zt(o);if(c===null)return R.error("String value failed sanitization",{key:e}),!1;o=c}const n=JSON.stringify(o),l=5*1024*1024;return n.length>l?(R.error("Storage size exceeds limit",{key:e,size:n.length,maxSize:l}),!1):(localStorage.setItem(e,n),!0)}catch(n){return R.error("Failed to set item to LocalStorage",{key:e,error:n}),!1}}remove(e,o={}){if(!this.isAvailable())return o.silent||R.warn("LocalStorage is not available",{key:e}),!1;try{return localStorage.removeItem(e),!0}catch(r){return R.error("Failed to remove item from LocalStorage",{key:e,error:r}),!1}}clearGameData(){if(!this.isAvailable())return!1;try{const o=Object.keys(localStorage).filter(r=>r.startsWith("chipPuzzleGame_"));return o.forEach(r=>localStorage.removeItem(r)),R.info("Game data cleared",{count:o.length}),!0}catch(e){return R.error("Failed to clear game data",{error:e}),!1}}available(){return this.isAvailable()}}const Oe=new eo;function ft(s){const e="/ChipPuzzleGame/",o=e.endsWith("/")?e:`${e}/`,r=s.startsWith("/")?s.slice(1):s;return`${o}${r}`}const Ct=p.memo(({onNavigate:s,currentScreen:e})=>{const{t:o}=Be(),[r,a]=p.useState(()=>{var b;return(b=Oe.get("chipPuzzleGame_soundEnabled",{fallback:!0,silent:!0}))!=null?b:!0}),[n,l]=p.useState(!1);p.useEffect(()=>{de.setEnabled(r),Oe.set("chipPuzzleGame_soundEnabled",r,{silent:!0})},[r]),p.useEffect(()=>(n?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[n]),p.useEffect(()=>{const b=g=>{const y=g.target;n&&!y.closest(".header-nav")&&!y.closest(".header-hamburger")&&l(!1)};if(n)return document.addEventListener("click",b),()=>{document.removeEventListener("click",b)}},[n]);const c=b=>{s&&s(b),l(!1)},i=()=>{a(!r),r||de.playClick()},f=()=>{l(!n),r&&de.playClick()},h=!1;return u.jsx("header",{className:"header",children:u.jsxs("div",{className:"header-content",children:[u.jsxs("div",{className:"header-left",children:[h,u.jsxs("div",{className:"header-logo",onClick:()=>c("stageSelect"),style:{cursor:"pointer",display:"flex",alignItems:"center",gap:"12px"},children:[u.jsx("img",{src:ft("ChipGames_Logo.png"),onError:b=>{const g=b.target;g.src&&!g.src.includes(".svg")&&(g.src=ft("ChipGames_Logo.svg"))},alt:o("header.gameTitle")+" - CHIP GAMES Î°úÍ≥†",style:{height:"40px",width:"auto"},loading:"eager",width:"120",height:"40"}),u.jsx("span",{className:"header-game-title",children:o("header.gameTitle")})]})]}),u.jsxs("nav",{className:`header-nav ${n?"mobile-open":""}`,children:[u.jsx("button",{className:"header-nav-button",onClick:()=>c("stageSelect"),children:o("header.playGame")}),u.jsx("button",{className:"header-nav-button",onClick:()=>c("guide"),children:o("header.guide")}),u.jsx("button",{className:"header-nav-button",onClick:()=>c("help"),children:o("header.help")}),u.jsx("button",{className:"header-nav-button",onClick:()=>c("about"),children:o("header.about")})]}),u.jsxs("div",{className:"header-right",children:[u.jsx("button",{className:"header-sound-button",onClick:i,title:o(r?"header.soundOff":"header.soundOn"),children:r?"üîä":"üîá"}),u.jsx(vt,{}),u.jsxs("button",{className:"header-hamburger",onClick:f,"aria-label":"Î©îÎâ¥","aria-expanded":n,children:[u.jsx("span",{className:`hamburger-line ${n?"active":""}`}),u.jsx("span",{className:`hamburger-line ${n?"active":""}`}),u.jsx("span",{className:`hamburger-line ${n?"active":""}`})]})]})]})})});Ct.displayName="Header";const to="1.1.0",Rt=p.memo(()=>{const{t:s}=Be(),[e,o]=p.useState(!1),[r,a]=p.useState(!1),n=i=>{i.preventDefault(),o(!0),de.playClick(),R.info("Privacy policy modal opened")},l=i=>{i.preventDefault(),a(!0),de.playClick(),R.info("Contact modal opened")},c=()=>{o(!1),a(!1),de.playClick()};return p.useEffect(()=>{const i=f=>{f.key==="Escape"&&(e||r)&&c()};return(e||r)&&(document.addEventListener("keydown",i),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",i),document.body.style.overflow=""}},[e,r]),u.jsxs(u.Fragment,{children:[u.jsx("footer",{className:"footer",role:"contentinfo",children:u.jsxs("div",{className:"footer-content",children:[u.jsxs("nav",{className:"footer-links","aria-label":s("footer.navigation"),children:[u.jsx("a",{href:"#privacy",onClick:n,"aria-label":s("footer.privacyPolicy"),className:"footer-link",children:s("footer.privacyPolicy")}),u.jsx("a",{href:"#contact",onClick:l,"aria-label":s("footer.contactUs"),className:"footer-link",children:s("footer.contactUs")})]}),u.jsx("div",{className:"footer-center",children:u.jsx(vt,{})}),u.jsxs("div",{className:"footer-copyright","aria-label":s("footer.copyright"),children:[s("footer.copyright")," | v",to]})]})}),e&&u.jsx("div",{className:"footer-modal-overlay",onClick:c,role:"dialog","aria-modal":"true","aria-labelledby":"privacy-modal-title",children:u.jsxs("div",{className:"footer-modal",onClick:i=>i.stopPropagation(),children:[u.jsxs("div",{className:"footer-modal-header",children:[u.jsx("h2",{id:"privacy-modal-title",children:s("footer.privacyPolicy")}),u.jsx("button",{className:"footer-modal-close",onClick:c,"aria-label":s("common.close"),children:"√ó"})]}),u.jsxs("div",{className:"footer-modal-content",children:[u.jsxs("div",{className:"footer-modal-section",children:[u.jsx("h3",{children:s("footer.privacySection1Title")}),u.jsx("p",{children:s("footer.privacySection1Content")})]}),u.jsxs("div",{className:"footer-modal-section",children:[u.jsx("h3",{children:s("footer.privacySection2Title")}),u.jsx("p",{children:s("footer.privacySection2Content")})]}),u.jsxs("div",{className:"footer-modal-section",children:[u.jsx("h3",{children:s("footer.privacySection3Title")}),u.jsx("p",{children:s("footer.privacySection3Content")})]}),u.jsxs("div",{className:"footer-modal-section",children:[u.jsx("h3",{children:s("footer.privacySection4Title")}),u.jsx("p",{children:s("footer.privacySection4Content")})]}),u.jsxs("div",{className:"footer-modal-section",children:[u.jsx("h3",{children:s("footer.privacySection5Title")}),u.jsx("p",{children:s("footer.privacySection5Content")})]}),u.jsxs("div",{className:"footer-modal-section",children:[u.jsx("h3",{children:s("footer.privacySection6Title")}),u.jsx("p",{children:s("footer.privacySection6Content")})]})]})]})}),r&&u.jsx("div",{className:"footer-modal-overlay",onClick:c,role:"dialog","aria-modal":"true","aria-labelledby":"contact-modal-title",children:u.jsxs("div",{className:"footer-modal",onClick:i=>i.stopPropagation(),children:[u.jsxs("div",{className:"footer-modal-header",children:[u.jsx("h2",{id:"contact-modal-title",children:s("footer.contactUs")}),u.jsx("button",{className:"footer-modal-close",onClick:c,"aria-label":s("common.close"),children:"√ó"})]}),u.jsxs("div",{className:"footer-modal-content",children:[u.jsxs("div",{className:"footer-modal-section",children:[u.jsx("h3",{children:s("footer.contactSection1Title")}),u.jsx("p",{children:s("footer.contactSection1Content")})]}),u.jsxs("div",{className:"footer-modal-section",children:[u.jsx("h3",{children:s("footer.contactSection2Title")}),u.jsx("p",{children:s("footer.contactSection2Content")})]}),u.jsxs("div",{className:"footer-modal-section",children:[u.jsx("h3",{children:s("footer.contactSection3Title")}),u.jsx("p",{children:s("footer.contactSection3Content")})]}),u.jsxs("div",{className:"footer-modal-section",children:[u.jsx("h3",{children:s("footer.contactSection4Title")}),u.jsx("p",{children:s("footer.contactSection4Content")})]})]})]})})]})});Rt.displayName="Footer";const oo=({children:s})=>u.jsx("div",{className:"game-container",children:s}),Mt={aspectRatio:16/9,gridRows:9,gridCols:9,pixelRatio:window.devicePixelRatio||1};const ro=({config:s,onReady:e,onResize:o})=>{const r=p.useRef(null),a=p.useRef(null),n=p.useRef(e),l=p.useRef(o),c=p.useRef(!1),[i,f]=p.useState(null),{t:h}=Be();return p.useEffect(()=>{n.current=e},[e]),p.useEffect(()=>{l.current=o},[o]),p.useEffect(()=>{const b=r.current,g=a.current;if(!b||!g)return;const y=b.getContext("2d");if(!y){const z="Canvas 2D context is not supported";R.error(z),f(z);return}i&&f(null);const T=()=>{const z=window.devicePixelRatio||1,D=g.clientWidth,ee=g.clientHeight,Y=s.aspectRatio||Mt.aspectRatio||16/9,O=1200,V=675;let K,ye;const Se=Math.min(D,O),Q=Math.min(ee,V);Se/Q>Y?(ye=Q,K=ye*Y):(K=Se,ye=K/Y),b.width=K*z,b.height=ye*z,y.scale(z,z),b.style.width=`${K}px`,b.style.height=`${ye}px`,b.style.display="block",b.style.maxWidth="100%",b.style.maxHeight="100%",!c.current&&n.current&&(c.current=!0,n.current(b,y)),c.current&&l.current&&setTimeout(()=>{l.current&&l.current(b,y)},0)};T();const H=new ResizeObserver(()=>{T()});return H.observe(g),()=>{H.disconnect(),c.current=!1}},[s]),i?u.jsx("div",{className:"game-canvas-error",role:"alert",children:u.jsxs("div",{className:"game-canvas-error-content",children:[u.jsx("div",{className:"game-canvas-error-icon",children:"‚ö†Ô∏è"}),u.jsx("h3",{children:h("error.canvasNotSupported")}),u.jsx("p",{children:h("error.canvasFallbackMessage")}),u.jsx("button",{onClick:()=>{f(null),window.location.reload()},className:"game-canvas-error-button",children:h("error.reload")})]})}):u.jsx("div",{ref:a,className:"game-canvas-wrapper",children:u.jsx("canvas",{ref:r,className:"game-canvas",tabIndex:0,role:"application","aria-label":"Îß§Ïπ≠ ÌçºÏ¶ê Í≤åÏûÑ Î≥¥Îìú","aria-live":"polite","aria-atomic":"true"})})},_e=["red","yellow","blue","green","purple","orange"],De={red:{light:"#e74c3c",dark:"#c0392b"},yellow:{light:"#f1c40f",dark:"#f39c12"},blue:{light:"#3498db",dark:"#2980b9"},green:{light:"#2ecc71",dark:"#27ae60"},purple:{light:"#9b59b6",dark:"#8e44ad"},orange:{light:"#e67e22",dark:"#d35400"}};class so{constructor(e,o){F(this,"ctx");F(this,"cellSize");this.ctx=e,this.cellSize=o}render(e,o=1){this.ctx.save();const r=e.x+this.cellSize/2,a=e.y+this.cellSize/2,n=e.scale||1,l=e.rotation||0;switch(n===1&&l===0?this.ctx.translate(r,a):(this.ctx.translate(r,a),this.ctx.scale(n,n),this.ctx.rotate(l)),o<1&&(this.ctx.globalAlpha=o),e.type){case"normal":this.renderNormalGem(e);break;case"striped":this.renderStripedGem(e);break;case"wrapped":this.renderWrappedGem(e);break;case"colorBomb":this.renderColorBomb(e);break}this.ctx.restore()}renderNormalGem(e){const o=De[e.color],r=this.cellSize*.85,a=-r/2;this.ctx.fillStyle="rgba(0, 0, 0, 0.2)",this.roundRect(a+2,a+2,r,r,r*.2),this.ctx.fill();const n=this.ctx.createLinearGradient(a,a,a+r,a+r);n.addColorStop(0,o.light),n.addColorStop(1,o.dark),this.ctx.fillStyle=n,this.roundRect(a,a,r,r,r*.2),this.ctx.fill(),this.renderColorPattern(e.color,a,r),this.ctx.fillStyle="rgba(255, 255, 255, 0.3)",this.roundRect(a,a,r,r*.4,r*.2),this.ctx.fill(),this.ctx.strokeStyle=this.getBorderColor(e.color),this.ctx.lineWidth=r*.06,this.roundRect(a,a,r,r,r*.2),this.ctx.stroke()}getBorderColor(e){return{red:"rgba(231, 76, 60, 0.9)",yellow:"rgba(241, 196, 15, 0.9)",blue:"rgba(52, 152, 219, 0.9)",green:"rgba(46, 204, 113, 0.9)",purple:"rgba(155, 89, 182, 0.9)",orange:"rgba(230, 126, 34, 0.9)"}[e]}renderColorPattern(e,o,r){switch(this.ctx.save(),this.ctx.globalAlpha=.5,e){case"red":this.ctx.fillStyle="rgba(255, 255, 255, 0.6)",this.ctx.beginPath(),this.ctx.arc(0,0,r*.18,0,Math.PI*2),this.ctx.fill(),this.ctx.fillStyle="rgba(192, 57, 43, 0.5)",this.ctx.beginPath(),this.ctx.arc(0,0,r*.1,0,Math.PI*2),this.ctx.fill();break;case"yellow":this.ctx.fillStyle="rgba(255, 255, 255, 0.7)",this.drawStar(0,0,r*.1,r*.18,5),this.ctx.fill();break;case"blue":this.ctx.fillStyle="rgba(255, 255, 255, 0.6)",this.ctx.beginPath(),this.ctx.moveTo(0,-r*.18),this.ctx.lineTo(r*.18,0),this.ctx.lineTo(0,r*.18),this.ctx.lineTo(-r*.18,0),this.ctx.closePath(),this.ctx.fill();break;case"green":this.ctx.fillStyle="rgba(255, 255, 255, 0.6)",this.ctx.beginPath(),this.ctx.moveTo(0,-r*.18),this.ctx.lineTo(-r*.15,r*.12),this.ctx.lineTo(r*.15,r*.12),this.ctx.closePath(),this.ctx.fill();break;case"purple":this.ctx.fillStyle="rgba(255, 255, 255, 0.6)",this.ctx.fillRect(-r*.12,-r*.12,r*.24,r*.24);break;case"orange":this.ctx.fillStyle="rgba(255, 255, 255, 0.6)",this.ctx.beginPath();for(let a=0;a<6;a++){const n=Math.PI/3*a,l=Math.cos(n)*r*.15,c=Math.sin(n)*r*.15;a===0?this.ctx.moveTo(l,c):this.ctx.lineTo(l,c)}this.ctx.closePath(),this.ctx.fill(),this.ctx.fillStyle="rgba(211, 84, 0, 0.5)",this.ctx.beginPath(),this.ctx.arc(0,0,r*.08,0,Math.PI*2),this.ctx.fill();break}this.ctx.restore()}renderStripedGem(e){const o=De[e.color],r=this.cellSize*.85,a=-r/2,n=this.ctx.createLinearGradient(a,a,a+r,a+r);if(n.addColorStop(0,o.light),n.addColorStop(1,o.dark),this.ctx.fillStyle=n,this.roundRect(a,a,r,r,r*.2),this.ctx.fill(),this.ctx.strokeStyle="rgba(255, 255, 255, 0.6)",this.ctx.lineWidth=r*.1,this.ctx.lineCap="round",e.stripedDirection==="horizontal")for(let l=0;l<3;l++){const c=a+r/4*(l+1);this.ctx.beginPath(),this.ctx.moveTo(a,c),this.ctx.lineTo(a+r,c),this.ctx.stroke()}else for(let l=0;l<3;l++){const c=a+r/4*(l+1);this.ctx.beginPath(),this.ctx.moveTo(c,a),this.ctx.lineTo(c,a+r),this.ctx.stroke()}}renderWrappedGem(e){const o=De[e.color],r=this.cellSize*.85,a=-r/2,n=this.ctx.createLinearGradient(a,a,a+r,a+r);n.addColorStop(0,o.light),n.addColorStop(1,o.dark),this.ctx.fillStyle=n,this.roundRect(a,a,r,r,r*.2),this.ctx.fill(),this.ctx.strokeStyle="rgba(255, 255, 255, 0.8)",this.ctx.lineWidth=r*.08,this.ctx.lineCap="round",this.ctx.beginPath(),this.ctx.moveTo(a,a),this.ctx.lineTo(a+r,a+r),this.ctx.moveTo(a+r,a),this.ctx.lineTo(a,a+r),this.ctx.stroke()}renderColorBomb(e){const o=this.cellSize*.85,r=-o/2,a=this.ctx.createLinearGradient(r,r,r+o,r+o);a.addColorStop(0,"#ff6b6b"),a.addColorStop(.2,"#ffd93d"),a.addColorStop(.4,"#4ecdc4"),a.addColorStop(.6,"#95e1d3"),a.addColorStop(.8,"#a29bfe"),a.addColorStop(1,"#fd79a8"),this.ctx.fillStyle=a,this.roundRect(r,r,o,o,o*.2),this.ctx.fill(),this.ctx.fillStyle="rgba(255, 255, 255, 0.9)",this.drawStar(0,0,o*.3,o*.6,5),this.ctx.fill()}roundRect(e,o,r,a,n){this.ctx.beginPath(),this.ctx.moveTo(e+n,o),this.ctx.lineTo(e+r-n,o),this.ctx.quadraticCurveTo(e+r,o,e+r,o+n),this.ctx.lineTo(e+r,o+a-n),this.ctx.quadraticCurveTo(e+r,o+a,e+r-n,o+a),this.ctx.lineTo(e+n,o+a),this.ctx.quadraticCurveTo(e,o+a,e,o+a-n),this.ctx.lineTo(e,o+n),this.ctx.quadraticCurveTo(e,o,e+n,o),this.ctx.closePath()}drawStar(e,o,r,a,n){this.ctx.beginPath();for(let l=0;l<n*2;l++){const c=Math.PI*l/n,i=l%2===0?a:r,f=e+Math.cos(c)*i,h=o+Math.sin(c)*i;l===0?this.ctx.moveTo(f,h):this.ctx.lineTo(f,h)}this.ctx.closePath()}}const dt={rows:9,cols:9};function Ge(s){var r,a;const e=[],o=new Set;for(let n=0;n<s.length;n++){let l=1,c=(r=s[n][0])==null?void 0:r.color,i=0;for(let f=1;f<=s[n].length;f++){const h=s[n][f];if(h&&h.color===c&&c)l++;else{if(l>=3&&c){const b=[];for(let g=0;g<l;g++){const y={row:n,col:i+g},T=`${y.row},${y.col}`;o.has(T)||(b.push(y),o.add(T))}b.length>0&&e.push({type:"horizontal",positions:b})}h?(l=1,c=h.color,i=f):(l=0,c=void 0)}}}if(s.length>0)for(let n=0;n<s[0].length;n++){let l=1,c=(a=s[0][n])==null?void 0:a.color,i=0;for(let f=1;f<=s.length;f++){const h=f<s.length?s[f][n]:null;if(h&&h.color===c&&c)l++;else{if(l>=3&&c){const b=[];for(let g=0;g<l;g++){const y={row:i+g,col:n},T=`${y.row},${y.col}`;o.has(T)||(b.push(y),o.add(T))}b.length>0&&e.push({type:"vertical",positions:b})}h?(l=1,c=h.color,i=f):(l=0,c=void 0)}}}return e}class no{constructor(e){F(this,"seed");this.seed=e}next(){return this.seed=(this.seed*9301+49297)%233280,this.seed/233280}}function ut(s){const e=new no(s),o=ao(s),r=io(s),a=lo(s),n=co(o.rows,o.cols,e);return{stageNumber:s,gridSize:o,targetScore:r,maxMoves:a,goals:[{type:"score",target:r,current:0}],initialBoard:n}}function ao(s){return s<=100?{rows:9,cols:9}:s<=300?{rows:8,cols:8}:s<=600?{rows:7,cols:7}:{rows:6,cols:6}}function io(s){const r=Math.floor(s/100)*500;return 1e3+s*50+r}function lo(s){const o=Math.floor(s/20),r=20;return s>500?Math.max(r,50-o-Math.floor((s-500)/10)):Math.max(r,50-o)}function co(s,e,o){const r=[];for(let a=0;a<s;a++){r[a]=[];for(let n=0;n<e;n++){const l=_e[Math.floor(o.next()*_e.length)];r[a][n]={id:`${a}-${n}-${Date.now()}`,color:l,type:"normal",position:{row:a,col:n},x:0,y:0,targetX:void 0,targetY:void 0,scale:1,rotation:0}}}return fo(r,o)}function fo(s,e){var n,l,c,i,f;let r=0;const a=e?()=>e.next():()=>Math.random();try{for(;r<100;){const h=Ge(s);if(h.length===0)return s;for(const b of h)for(const g of b.positions){const y=(n=s[g.row])==null?void 0:n[g.col];if(y){const T=_e.indexOf(y.color),H=_e.filter((ee,Y)=>Y!==T);if(H.length===0)continue;let z=y.color,D=0;for(;D<10&&z===y.color;){const ee=Math.floor(a()*H.length),Y=H[ee];[(l=s[g.row-1])==null?void 0:l[g.col],(c=s[g.row+1])==null?void 0:c[g.col],(i=s[g.row])==null?void 0:i[g.col-1],(f=s[g.row])==null?void 0:f[g.col+1]].filter(Boolean).some(K=>(K==null?void 0:K.color)===Y)?D++:z=Y}z===y.color&&H.length>0&&(z=H[0]),y.color=z}}r++}}catch(h){R.error("Error in ensureNoInitialMatches",{error:h})}return s}function ht(s,e=50){var n;const o=s.map(l=>[...l]),r=o.length,a=((n=o[0])==null?void 0:n.length)||0;for(let l=0;l<a;l++){let c=r-1;for(let i=r-1;i>=0;i--)if(o[i][l]!==null){if(c!==i){const f=o[i][l];o[c][l]=f,(f.y===void 0||f.y===0)&&(f.y=i*e),f.targetY=c,f.position.row=c,o[i][l]=null}c--}for(let i=c;i>=0;i--){const f=uo(i,l);f.y=-e*(c-i+1),f.targetY=i,o[i][l]=f}}return o}function uo(s,e){const o=_e[Math.floor(Math.random()*_e.length)];return{id:`${Date.now()}-${s}-${e}-${Math.random()}`,color:o,type:"normal",position:{row:s,col:e},x:0,y:0,targetX:void 0,targetY:void 0,scale:1,rotation:0}}function ho(s){const e=[];for(const o of s){const r=o.positions.length;if(r===4){const a=Math.floor(r/2),n=o.positions[a];e.push({position:n,type:"striped",stripedDirection:o.type==="horizontal"?"horizontal":"vertical"})}else if(r>=5){const a=Math.floor(r/2),n=o.positions[a];e.push({position:n,type:"colorBomb"})}}return e}function mo(s){const e=[],o=s.filter(a=>a.type==="horizontal"),r=s.filter(a=>a.type==="vertical");for(const a of o)for(const n of r){const l=a.positions.find(c=>n.positions.some(i=>c.row===i.row&&c.col===i.col));l&&e.push({position:l,type:"wrapped"})}return e}function go(s){const e=mo(s),o=s.filter(n=>!e.some(l=>{var c,i;return l.position.row===((c=n.positions[0])==null?void 0:c.row)&&l.position.col===((i=n.positions[0])==null?void 0:i.col)})),r=[];r.push(...e);const a=ho(o);for(const n of a)e.some(c=>c.position.row===n.position.row&&c.position.col===n.position.col)||r.push(n);return r}function po(s,e,o){var l,c,i;const r=[],{row:a,col:n}=s.position;if(o==="horizontal")for(let f=0;f<((l=e[0])==null?void 0:l.length);f++)(c=e[a])!=null&&c[f]&&r.push({row:a,col:f});else for(let f=0;f<e.length;f++)(i=e[f])!=null&&i[n]&&r.push({row:f,col:n});return{positionsToRemove:r,score:r.length*20}}function yo(s,e){var n,l;const o=[],{row:r,col:a}=s.position;for(let c=r-1;c<=r+1;c++)for(let i=a-1;i<=a+1;i++)c>=0&&c<e.length&&i>=0&&i<(((n=e[0])==null?void 0:n.length)||0)&&((l=e[c])!=null&&l[i])&&o.push({row:c,col:i});return{positionsToRemove:o,score:o.length*30}}function bo(s,e){var a,n;const o=[],r=s.color;for(let l=0;l<e.length;l++)for(let c=0;c<(((a=e[l])==null?void 0:a.length)||0);c++){const i=(n=e[l])==null?void 0:n[c];i&&i.color===r&&o.push({row:l,col:c})}return{positionsToRemove:o,score:o.length*50}}function wo(s,e,o){var c,i,f;const r=[],{row:a,col:n}=s.position;for(let h=0;h<((c=o[0])==null?void 0:c.length);h++)(i=o[a])!=null&&i[h]&&r.push({row:a,col:h});for(let h=0;h<o.length;h++)(f=o[h])!=null&&f[n]&&r.push({row:h,col:n});const l=Array.from(new Set(r.map(h=>`${h.row},${h.col}`))).map(h=>{const[b,g]=h.split(",").map(Number);return{row:b,col:g}});return{positionsToRemove:l,score:l.length*30}}function So(s,e,o){var f,h,b,g;const r=[],a=s.type==="striped"?s:e,n=s.type==="wrapped"?s:e,l=a.stripedDirection||"horizontal",{row:c,col:i}=n.position;if(l==="horizontal"){for(let y=c-1;y<=c+1;y++)if(y>=0&&y<o.length)for(let T=0;T<((f=o[0])==null?void 0:f.length);T++)(h=o[y])!=null&&h[T]&&r.push({row:y,col:T})}else for(let y=i-1;y<=i+1;y++)if(y>=0&&y<(((b=o[0])==null?void 0:b.length)||0))for(let T=0;T<o.length;T++)(g=o[T])!=null&&g[y]&&r.push({row:T,col:y});return{positionsToRemove:r,score:r.length*40}}function vo(s,e,o){var c,i,f,h;const r=[],a=s.type==="striped"?s:e,n=a.color;if((a.stripedDirection||"horizontal")==="horizontal")for(let b=0;b<o.length;b++)for(let g=0;g<(((c=o[b])==null?void 0:c.length)||0);g++){const y=(i=o[b])==null?void 0:i[g];y&&y.color===n&&r.push({row:b,col:g})}else for(let b=0;b<(((f=o[0])==null?void 0:f.length)||0);b++)for(let g=0;g<o.length;g++){const y=(h=o[g])==null?void 0:h[b];y&&y.color===n&&r.push({row:g,col:b})}return{positionsToRemove:r,score:r.length*60}}function Co(s,e,o){var l,c;const r=[],{row:a,col:n}=s.position;for(let i=a-2;i<=a+2;i++)for(let f=n-2;f<=n+2;f++)i>=0&&i<o.length&&f>=0&&f<(((l=o[0])==null?void 0:l.length)||0)&&((c=o[i])!=null&&c[f])&&r.push({row:i,col:f});return{positionsToRemove:r,score:r.length*50}}function Ro(s,e,o){var l,c;const r=[],n=(s.type==="wrapped"?s:e).color;for(let i=0;i<o.length;i++)for(let f=0;f<(((l=o[i])==null?void 0:l.length)||0);f++){const h=(c=o[i])==null?void 0:c[f];h&&h.color===n&&r.push({row:i,col:f})}return{positionsToRemove:r,score:r.length*70}}function Mo(s,e,o){var a,n;const r=[];for(let l=0;l<o.length;l++)for(let c=0;c<(((a=o[l])==null?void 0:a.length)||0);c++)(n=o[l])!=null&&n[c]&&r.push({row:l,col:c});return{positionsToRemove:r,score:r.length*100}}function Po(s,e,o){switch([s.type,e.type].sort().join("+")){case"striped+striped":return wo(s,e,o);case"striped+wrapped":return So(s,e,o);case"colorBomb+striped":return vo(s,e,o);case"wrapped+wrapped":return Co(s,e,o);case"colorBomb+wrapped":return Ro(s,e,o);case"colorBomb+colorBomb":return Mo(s,e,o);default:return null}}function ko(s,e){switch(s.type){case"striped":return po(s,e,s.stripedDirection||"horizontal");case"wrapped":return yo(s,e);case"colorBomb":return bo(s,e);default:return{positionsToRemove:[],score:0}}}const To=s=>{const[e,o]=p.useState(()=>{const i=ut(s);return{board:i.initialBoard||[],score:0,moves:i.maxMoves,goals:i.goals,isGameOver:!1,isPaused:!1,currentStage:s,isAnimating:!1,selectedGem:null,comboCount:0}});p.useEffect(()=>{const i=ut(s);o({board:i.initialBoard||[],score:0,moves:i.maxMoves,goals:i.goals,isGameOver:!1,isPaused:!1,currentStage:s,isAnimating:!1,selectedGem:null,comboCount:0})},[s]);const r=p.useRef(null),a=p.useCallback((i,f)=>{o(h=>{var g,y;if(h.isGameOver)return h;const b=((g=h.selectedGem)==null?void 0:g.row)===i&&((y=h.selectedGem)==null?void 0:y.col)===f?null:{row:i,col:f};return r.current=b,ke(fe({},h),{selectedGem:b})})},[]),n=p.useCallback((i,f)=>{o(h=>{var Y;if(h.isGameOver||h.moves<=0)return h;const b=Math.abs(i.row-f.row),g=Math.abs(i.col-f.col);if(!(b===1&&g===0||b===0&&g===1))return h;const y=h.board.map(O=>O.map(V=>V?fe({},V):null)),T=y[i.row][i.col],H=y[f.row][f.col];if(T&&H&&T.type!=="normal"&&H.type!=="normal"){const O=Po(T,H,y);if(O){const V=new Set;for(const x of O.positionsToRemove)V.add(`${x.row},${x.col}`);for(const x of V){const[N,ae]=x.split(","),A=Number(N),he=Number(ae);!Number.isNaN(A)&&!Number.isNaN(he)&&y[A]&&(y[A][he]=null)}const K=ht(y,50),ye=h.score+O.score,Se=h.goals.map(x=>x.type==="score"?ke(fe({},x),{current:Math.min(x.current+O.score,x.target)}):x),ue=Ge(K).length>0,U=Se.every(x=>x.current>=x.target),Re=h.moves<=0&&!U;return ke(fe({},h),{board:K,score:ye,goals:Se,moves:h.moves-1,isAnimating:ue&&!U&&!Re,selectedGem:null,comboCount:0,isGameOver:Re||h.isGameOver})}}const z=y[i.row][i.col];y[i.row][i.col]=y[f.row][f.col],y[f.row][f.col]=z,y[i.row][i.col]&&(y[i.row][i.col].position=fe({},i)),y[f.row][f.col]&&(y[f.row][f.col].position=fe({},f));const D=Ge(y);if(D.length===0)return h;const ee=go(D);for(const O of ee){const V=(Y=y[O.position.row])==null?void 0:Y[O.position.col];V&&(V.type=O.type,O.stripedDirection&&(V.stripedDirection=O.stripedDirection))}return ke(fe({},h),{board:y,moves:h.moves-1,isAnimating:!0,selectedGem:null,comboCount:0})})},[]),l=p.useCallback(()=>{o(i=>{var U,Re;if(!i.isAnimating)return i;const f=Ge(i.board);if(f.length===0)return ke(fe({},i),{isAnimating:!1});const h=i.board.map(x=>x.map(N=>N?fe({},N):null)),b=new Set;let g=0;const y=new Set;for(const x of f)for(const N of x.positions){const ae=(U=h[N.row])==null?void 0:U[N.col];ae&&ae.type!=="normal"&&y.add(`${N.row},${N.col}`)}for(const x of y){const[N,ae]=x.split(","),A=Number(N),he=Number(ae);if(!Number.isNaN(A)&&!Number.isNaN(he)&&((Re=h[A])!=null&&Re[he])){const m=h[A][he],Ae=ko(m,h);for(const Le of Ae.positionsToRemove)b.add(`${Le.row},${Le.col}`);g+=Ae.score}}for(const x of f)for(const N of x.positions)b.add(`${N.row},${N.col}`);for(const x of b){const[N,ae]=x.split(","),A=Number(N),he=Number(ae);!Number.isNaN(A)&&!Number.isNaN(he)&&h[A]&&(h[A][he]=null)}const T=ht(h,50),z=Ge(T).length>0,D=z?i.comboCount+1:0,ee=1+Math.min(D,5)*.15,Y=f.reduce((x,N)=>{const ae=N.positions.length;let A=10;return ae>=6?A=80:ae>=5?A=40:ae>=4&&(A=20),x+ae*A},0),O=Y+g,V=Math.floor(O*(ee-1)),K=i.score+O+V,ye=Y+g+V,Se=i.goals.map(x=>x.type==="score"?ke(fe({},x),{current:Math.min(x.current+ye,x.target)}):x),Q=Se.every(x=>x.current>=x.target),ue=i.moves<=0&&!Q;return ke(fe({},i),{board:T,score:K,goals:Se,isGameOver:ue||i.isGameOver,isAnimating:z&&!Q&&!ue,comboCount:D})})},[]),c=p.useCallback(()=>{o(i=>ke(fe({},i),{isPaused:!i.isPaused}))},[]);return{gameState:e,selectGem:a,swapGems:n,processMatches:l,togglePause:c}};function mt(s){const{score:e,goals:o,moves:r,currentStage:a}=s;if(o.length===0)return 0;const n=o[0];if(n.current<n.target)return 0;const l=n.current/n.target,c=Math.max(20,50-Math.floor(a/20)),i=r/c,f=Math.min(e/(n.target*1.5),1);let h=0;return l>=1&&(h=1,(l>=1.2||i>=.4)&&(h=2),l>=1.5&&i>=.5&&f>=.8&&(h=3)),Math.min(h,3)}class xo{constructor(e){F(this,"particles",[]);F(this,"ctx");this.ctx=e}emit(e,o,r,a=20){const n=De[r];for(let l=0;l<a;l++){const c=Math.PI*2*l/a+Math.random()*.5,i=2+Math.random()*3;this.particles.push({x:e,y:o,vx:Math.cos(c)*i,vy:Math.sin(c)*i,life:1,maxLife:1,color:Math.random()>.5?n.light:n.dark,size:3+Math.random()*4,rotation:Math.random()*Math.PI*2,rotationSpeed:(Math.random()-.5)*.2})}}emitExplosion(e,o,r,a=50,n=30){const l=De[r];for(let c=0;c<n;c++){const i=Math.random()*Math.PI*2,f=Math.random()*a,h=1+Math.random()*2;this.particles.push({x:e+Math.cos(i)*f*.3,y:o+Math.sin(i)*f*.3,vx:Math.cos(i)*h,vy:Math.sin(i)*h,life:1,maxLife:1,color:Math.random()>.5?l.light:l.dark,size:4+Math.random()*6,rotation:Math.random()*Math.PI*2,rotationSpeed:(Math.random()-.5)*.3})}}update(e=16){for(let o=this.particles.length-1;o>=0;o--){const r=this.particles[o];r.x+=r.vx,r.y+=r.vy,r.vy+=.1,r.vx*=.98,r.vy*=.98,r.rotation+=r.rotationSpeed,r.life-=e/1e3,r.life<=0&&this.particles.splice(o,1)}}render(){this.ctx.save();for(const e of this.particles){const o=e.life/e.maxLife,r=e.size*o;this.ctx.globalAlpha=o,this.ctx.fillStyle=e.color,this.ctx.translate(e.x,e.y),this.ctx.rotate(e.rotation),this.ctx.fillRect(-r/2,-r/2,r,r),this.ctx.setTransform(1,0,0,1,0,0)}this.ctx.globalAlpha=1,this.ctx.restore()}clear(){this.particles=[]}get count(){return this.particles.length}}function Je(s){var n,l,c,i;const e=s.length,o=((n=s[0])==null?void 0:n.length)||0,r=[],a=[];for(let f=0;f<e;f++)for(let h=0;h<o;h++){const b=(l=s[f])==null?void 0:l[h];if(b){if(h<o-1){const g=(c=s[f])==null?void 0:c[h+1];if(g&&g.color!==b.color){const y=gt(s,f,h,f,h+1),T=Ge(y);if(T.length>0){const H=T.some(D=>D.positions.length>=4),z={from:{row:f,col:h},to:{row:f,col:h+1}};H?r.push(z):a.push(z)}}}if(f<e-1){const g=(i=s[f+1])==null?void 0:i[h];if(g&&g.color!==b.color){const y=gt(s,f,h,f+1,h),T=Ge(y);if(T.length>0){const H=T.some(D=>D.positions.length>=4),z={from:{row:f,col:h},to:{row:f+1,col:h}};H?r.push(z):a.push(z)}}}}}return r.length>0?r[0]:a.length>0?a[0]:null}function gt(s,e,o,r,a){const n=s.map(c=>c.map(i=>i?fe({},i):null)),l=n[e][o];return n[e][o]=n[r][a],n[r][a]=l,n}class jo{constructor(){F(this,"data",{webVitals:[],gamePerformance:[],startTime:performance.now(),lastUpdate:performance.now()});F(this,"maxDataSize",100)}addWebVital(e){this.data.webVitals.push(e),this.data.webVitals.length>this.maxDataSize&&this.data.webVitals.shift(),this.data.lastUpdate=performance.now(),e.rating==="poor"&&R.warn(`Poor Web Vital detected: ${e.name}`,{value:e.value,rating:e.rating,threshold:this.getThreshold(e.name)})}addGamePerformance(e){this.data.gamePerformance.push(e),this.data.gamePerformance.length>this.maxDataSize&&this.data.gamePerformance.shift(),this.data.lastUpdate=performance.now()}getWebVitals(e){return e?this.data.webVitals.filter(o=>o.name===e):[...this.data.webVitals]}getGamePerformance(){return[...this.data.gamePerformance]}getAverageWebVital(e){const o=this.getWebVitals(e);return o.length===0?null:o.reduce((a,n)=>a+n.value,0)/o.length}getLatestWebVital(e){const o=this.getWebVitals(e);return o.length===0?null:o[o.length-1]}generateReport(){var a,n;const e={webVitals:{},gamePerformance:{averageFPS:0,averageFrameTime:0,minFPS:1/0,maxFPS:0,sampleCount:0},sessionDuration:performance.now()-this.data.startTime},o=["LCP","FID","CLS","FCP","TTFB"];for(const l of o){const c=this.getLatestWebVital(l),i=this.getAverageWebVital(l),f=this.getWebVitals(l);e.webVitals[l]={latest:(a=c==null?void 0:c.value)!=null?a:null,average:i,rating:(n=c==null?void 0:c.rating)!=null?n:"unknown",count:f.length}}const r=this.getGamePerformance();if(r.length>0){const l=r.map(i=>i.fps),c=r.map(i=>i.frameTime);e.gamePerformance={averageFPS:l.reduce((i,f)=>i+f,0)/l.length,averageFrameTime:c.reduce((i,f)=>i+f,0)/c.length,minFPS:Math.min(...l),maxFPS:Math.max(...l),sampleCount:r.length}}return e}logReport(){const e=this.generateReport();R.info("Performance Report",e)}getThreshold(e){var r;return(r={LCP:{good:2500,needsImprovement:4e3},FID:{good:100,needsImprovement:300},CLS:{good:.1,needsImprovement:.25},FCP:{good:1800,needsImprovement:3e3},TTFB:{good:800,needsImprovement:1800}}[e])!=null?r:{good:0,needsImprovement:0}}reset(){this.data={webVitals:[],gamePerformance:[],startTime:performance.now(),lastUpdate:performance.now()}}getAllData(){return{webVitals:[...this.data.webVitals],gamePerformance:[...this.data.gamePerformance],startTime:this.data.startTime,lastUpdate:this.data.lastUpdate}}}const Ze=new jo,Eo=Object.freeze(Object.defineProperty({__proto__:null,performanceAnalytics:Ze},Symbol.toStringTag,{value:"Module"}));class Go{constructor(){F(this,"fpsHistory",[]);F(this,"frameTimeHistory",[]);F(this,"lastFrameTime",performance.now());F(this,"frameCount",0);F(this,"fpsUpdateInterval",1e3);F(this,"lastFpsUpdate",performance.now());F(this,"currentFps",60);F(this,"currentFrameTime",16.67);F(this,"maxHistorySize",60);F(this,"callbacks",new Set)}update(){const e=performance.now(),o=e-this.lastFrameTime;if(this.lastFrameTime=e,this.frameTimeHistory.push(o),this.frameTimeHistory.length>this.maxHistorySize&&this.frameTimeHistory.shift(),this.frameCount++,e-this.lastFpsUpdate>=this.fpsUpdateInterval){this.currentFps=this.frameCount,this.currentFrameTime=1e3/this.currentFps,this.fpsHistory.push(this.currentFps),this.fpsHistory.length>this.maxHistorySize&&this.fpsHistory.shift();const r=this.frameTimeHistory.reduce((n,l)=>n+l,0)/this.frameTimeHistory.length,a=this.getMetrics(r);this.callbacks.forEach(n=>n(a));try{Ze.addGamePerformance(a)}catch(n){}this.currentFps<30&&this.handlePerformanceDegradation(),this.frameCount=0,this.lastFpsUpdate=e}}getMetrics(e){const o={fps:this.currentFps,frameTime:e,timestamp:performance.now()};if(performance.memory&&typeof performance.memory=="object"){const r=performance.memory;o.memoryUsage={usedJSHeapSize:r.usedJSHeapSize,totalJSHeapSize:r.totalJSHeapSize,jsHeapSizeLimit:r.jsHeapSizeLimit}}return o}handlePerformanceDegradation(){}subscribe(e){return this.callbacks.add(e),()=>{this.callbacks.delete(e)}}getFPS(){return this.currentFps}getAverageFPS(){return this.fpsHistory.length===0?60:this.fpsHistory.reduce((o,r)=>o+r,0)/this.fpsHistory.length}getFrameTime(){return this.currentFrameTime}getFPSHistory(){return[...this.fpsHistory]}getMemoryUsage(){if(performance.memory&&typeof performance.memory=="object"){const e=performance.memory;return{usedJSHeapSize:e.usedJSHeapSize,totalJSHeapSize:e.totalJSHeapSize,jsHeapSizeLimit:e.jsHeapSizeLimit}}return null}reset(){this.fpsHistory=[],this.frameTimeHistory=[],this.frameCount=0,this.currentFps=60,this.currentFrameTime=16.67,this.lastFrameTime=performance.now(),this.lastFpsUpdate=performance.now()}}const pt=new Go;const Ao=({stageNumber:s=1,currentScreen:e="stageSelect",onNavigate:o,onStartStage:r})=>{const a=p.useRef(!1),n=p.useRef(null),l=p.useRef(null),c=p.useRef(null),i=p.useRef(null),f=p.useRef(null),h=p.useRef(null),b=p.useRef(new Map),g=p.useRef(null),y=p.useRef(!1),T=p.useRef(null),H=p.useRef(""),z=p.useRef(!1),D=p.useRef(null),ee=p.useRef(null),Y=p.useRef(null),O=p.useRef(null),V=p.useRef(!1),K=p.useRef(!1),ye=p.useRef(!1),Se=p.useRef(!1),[Q,ue]=p.useState(!1),{t:U}=Be(),[Re,x]=p.useState(1),[N,ae]=p.useState(1),[A,he]=p.useState(null),{gameState:m,selectGem:Ae,swapGems:Le,processMatches:He,togglePause:$e}=To(s),[oe,kt]=p.useState(()=>{const S=dt.cols,E=dt.rows;return{aspectRatio:Mt.aspectRatio,cellSize:70,gridRows:E,gridCols:S,pixelRatio:window.devicePixelRatio||1,logicalWidth:0,logicalHeight:0}});p.useEffect(()=>{var t;if(e==="game"&&m.board.length>0){const S=m.board.length,E=((t=m.board[0])==null?void 0:t.length)||9;kt(P=>ke(fe({},P),{gridRows:S,gridCols:E}))}},[e,m.board,s]),p.useEffect(()=>{try{const t=Oe.get("chipPuzzleGame_progress",{fallback:null,silent:!0});t&&(x(Math.max(1,t.highestStage||1)),R.info("Game progress loaded",{highestStage:t.highestStage||1}))}catch(t){R.warn("Failed to recover game state",{error:t}),x(1)}},[]);const et=p.useCallback((t,S,E)=>{const d=S/1200;t.fillStyle="#1a1a1a",t.fillRect(0,0,S,E),t.fillStyle="#fff";const te=Math.max(16,32*d);t.font=`bold ${te}px Arial`,t.textAlign="center",t.fillText(U("stageSelect.title"),S/2,50*d);const v=8,ve=60,Te=15,k=ve*d,Ce=Te*d,Z=(S-(v*k+(v-1)*Ce))/2,X=100*d,re=1e3,ie=50,me=Math.ceil(re/ie),le=(N-1)*ie+1,q=Math.min(le+ie-1,re);for(let C=0;C<ie&&le+C<=q;C++){const G=le+C,W=Math.floor(C/v),$=C%v,w=Z+$*(k+Ce),_=X+W*(k+Ce),j=G<=Re;if(j){const L=t.createLinearGradient(w,_,w+k,_+k);L.addColorStop(0,"#667eea"),L.addColorStop(1,"#764ba2"),t.fillStyle=L}else t.fillStyle="#1a1a1a";t.fillRect(w,_,k,k),t.strokeStyle=j?"#667eea":"#444",t.lineWidth=Math.max(1,2*d),t.strokeRect(w,_,k,k),t.fillStyle="#fff";const I=Math.max(12,20*d);if(t.font=`bold ${I}px Arial`,t.textAlign="center",t.textBaseline="middle",t.fillText(G.toString(),w+k/2,_+k/2),!j){t.fillStyle="#ffa500";const L=Math.max(16,24*d);t.font=`${L}px Arial`,t.fillText("üîí",w+k/2,_+k/2-10*d)}}const ge=E-60*d;t.fillStyle="#fff",t.font=`bold ${Math.max(12,18*d)}px Arial`,t.textAlign="center",t.fillText(`${U("stageSelect.page")} ${N} / ${me}`,S/2,ge);const se=30*d,be=80*d,we=ge+20*d,xe=10*d;if(N>1){const C=S/2-be-xe/2;t.fillStyle=N>1?"#667eea":"#444",t.fillRect(C,we,be,se),t.strokeStyle="#fff",t.lineWidth=Math.max(1,2*d),t.strokeRect(C,we,be,se),t.fillStyle="#fff",t.font=`bold ${Math.max(10,14*d)}px Arial`,t.fillText("¬´",C+be/2,we+se/2+4*d)}if(N<me){const C=S/2+xe/2;t.fillStyle=N<me?"#667eea":"#444",t.fillRect(C,we,be,se),t.strokeStyle="#fff",t.lineWidth=Math.max(1,2*d),t.strokeRect(C,we,be,se),t.fillStyle="#fff",t.font=`bold ${Math.max(10,14*d)}px Arial`,t.fillText("¬ª",C+be/2,we+se/2+4*d)}},[Re,U,N]),tt=p.useCallback((t,S,E)=>{const d=S/1200;t.fillStyle="#1a1a1a",t.fillRect(0,0,S,E);const v=(oe.cellSize||70)*d,ve=oe.gridCols||9,Te=oe.gridRows||9,k=v*ve,Ce=v*Te,Z=(S-k)/2,X=(E-Ce)/2;(!c.current||i.current!==v)&&(c.current=new so(t,v),i.current=v),f.current||(f.current=new xo(t)),t.save(),t.globalAlpha=.9,t.fillStyle="rgba(22, 22, 46, 0.8)",t.beginPath(),t.roundRect(Z,X,k,Ce,8*d),t.fill(),t.restore(),t.strokeStyle="rgba(255, 255, 255, 0.08)",t.lineWidth=Math.max(.5,1*d);for(let C=0;C<=Te;C++){const G=X+C*v;t.beginPath(),t.moveTo(Z,G),t.lineTo(Z+k,G),t.stroke()}for(let C=0;C<=ve;C++){const G=Z+C*v;t.beginPath(),t.moveTo(G,X),t.lineTo(G,X+Ce),t.stroke()}const re=Math.max(10,20*d),ie=24*d,me=24*d,le=re+8*d,q=me,ge=16*d,se=16*d,be=280*d,we=le*4+ge*2;if(t.save(),t.globalAlpha=.9,t.fillStyle="rgba(15, 15, 30, 0.8)",t.beginPath(),t.roundRect(ie-ge,me-ge,be,we,se),t.fill(),t.strokeStyle="rgba(102, 126, 234, 0.3)",t.lineWidth=1*d,t.stroke(),t.restore(),t.textAlign="left",t.textBaseline="top",t.shadowColor="rgba(0, 0, 0, 0.5)",t.shadowBlur=4*d,t.shadowOffsetX=0,t.shadowOffsetY=2*d,t.font=`600 ${re}px -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif`,t.fillStyle="#ffffff",t.fillText(`${U("game.score")}: ${m.score.toLocaleString()}`,ie,q),t.fillStyle="rgba(255, 255, 255, 0.9)",t.fillText(`${U("game.moves")}: ${m.moves}`,ie,q+le),m.goals.length>0){const C=m.goals[0],G=C.current/C.target;t.fillStyle=G>=1?"#4ecdc4":"rgba(255, 255, 255, 0.9)",t.fillText(`${U("game.goal")}: ${C.current.toLocaleString()}/${C.target.toLocaleString()}`,ie,q+le*2)}if(m.comboCount>0&&(t.shadowColor="rgba(255, 217, 61, 0.6)",t.shadowBlur=12*d,t.font=`700 ${Math.max(14,24*d)}px -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif`,t.fillStyle="#ffd93d",t.textAlign="left",t.fillText(`${U("game.combo")} x${m.comboCount}!`,ie,q+le*3),t.shadowColor="rgba(0, 0, 0, 0.5)",t.shadowBlur=4*d),t.shadowColor="transparent",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0,!m.isGameOver&&!m.isAnimating){const W=20*d,$=10*d,w=120*d,_=40*d,j=120*d,I=40*d,L=S-w-W,J=W,M=12*d,B=t.createLinearGradient(L,J,L,J+_);B.addColorStop(0,Q?"#4ecdc4":"#667eea"),B.addColorStop(1,Q?"#44a08d":"#764ba2"),t.save(),t.beginPath(),t.roundRect(L,J,w,_,M),t.fillStyle=B,t.fill(),t.strokeStyle="rgba(255, 255, 255, 0.3)",t.lineWidth=Math.max(1,1.5*d),t.stroke(),t.restore(),t.shadowColor=Q?"rgba(78, 205, 196, 0.4)":"rgba(102, 126, 234, 0.4)",t.shadowBlur=8*d,t.shadowOffsetX=0,t.shadowOffsetY=2*d,t.fillStyle="#ffffff";const ce=16*d;t.font=`600 ${ce}px -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif`,t.textAlign="center",t.textBaseline="middle",t.fillText(U("game.hint"),L+w/2,J+_/2),t.shadowColor="transparent",t.shadowBlur=0;const pe=L-j-$,Me=W,ne=t.createLinearGradient(pe,Me,pe,Me+I);m.isPaused?(ne.addColorStop(0,"#ff6b6b"),ne.addColorStop(1,"#ee5a6f")):(ne.addColorStop(0,"#667eea"),ne.addColorStop(1,"#764ba2")),t.save(),t.beginPath(),t.roundRect(pe,Me,j,I,M),t.fillStyle=ne,t.fill(),t.strokeStyle="rgba(255, 255, 255, 0.3)",t.lineWidth=Math.max(1,1.5*d),t.stroke(),t.restore(),t.shadowColor=m.isPaused?"rgba(255, 107, 107, 0.4)":"rgba(102, 126, 234, 0.4)",t.shadowBlur=8*d,t.shadowOffsetX=0,t.shadowOffsetY=2*d,t.fillStyle="#ffffff";const Pe=16*d;t.font=`600 ${Pe}px -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif`,t.textAlign="center",t.textBaseline="middle",t.fillText(m.isPaused?U("game.resume"):U("game.pause"),pe+j/2,Me+I/2),t.shadowColor="transparent",t.shadowBlur=0}if(m.isPaused&&!m.isGameOver){t.fillStyle="rgba(15, 15, 30, 0.85)",t.fillRect(0,0,S,E);const C=400*d,G=200*d,W=(S-C)/2,$=(E-G)/2,w=24*d;t.save(),t.globalAlpha=.95,t.fillStyle="rgba(26, 26, 46, 0.9)",t.beginPath(),t.roundRect(W,$,C,G,w),t.fill(),t.strokeStyle="rgba(102, 126, 234, 0.3)",t.lineWidth=2*d,t.stroke(),t.restore(),t.shadowColor="rgba(102, 126, 234, 0.5)",t.shadowBlur=12*d,t.shadowOffsetX=0,t.shadowOffsetY=0,t.fillStyle="#ffffff",t.font=`700 ${Math.max(28,56*d)}px -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif`,t.textAlign="center",t.textBaseline="middle",t.fillText(U("game.pause"),S/2,$+G/2-30*d),t.shadowColor="transparent",t.shadowBlur=0,t.fillStyle="rgba(255, 255, 255, 0.7)",t.font=`500 ${Math.max(14,20*d)}px -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif`,t.fillText(U("game.resume"),S/2,$+G/2+20*d)}if(m.isGameOver){t.fillStyle="rgba(15, 15, 30, 0.9)",t.fillRect(0,0,S,E);const C=450*d,G=300*d,W=(S-C)/2,$=(E-G)/2,w=24*d;t.save(),t.globalAlpha=.95,t.fillStyle="rgba(26, 26, 46, 0.9)",t.beginPath(),t.roundRect(W,$,C,G,w),t.fill(),t.strokeStyle="rgba(255, 107, 107, 0.3)",t.lineWidth=2*d,t.stroke(),t.restore(),t.shadowColor="rgba(255, 107, 107, 0.5)",t.shadowBlur=12*d,t.fillStyle="#ff6b6b",t.font=`700 ${Math.max(28,56*d)}px -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif`,t.textAlign="center",t.textBaseline="middle",t.fillText(U("game.gameOver"),S/2,$+60*d),t.shadowColor="transparent",t.shadowBlur=0,t.fillStyle="rgba(255, 255, 255, 0.9)",t.font=`600 ${Math.max(16,24*d)}px -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif`,t.fillText(`${U("game.finalScore")}: ${m.score.toLocaleString()}`,S/2,$+120*d);const _=S/2-110*d,j=$+180*d,I=220*d,L=56*d,J=14*d,M=t.createLinearGradient(_,j,_,j+L);M.addColorStop(0,"#ff6b6b"),M.addColorStop(1,"#ee5a6f"),t.save(),t.beginPath(),t.roundRect(_,j,I,L,J),t.fillStyle=M,t.fill(),t.strokeStyle="rgba(255, 255, 255, 0.3)",t.lineWidth=2*d,t.stroke(),t.restore(),t.shadowColor="rgba(255, 107, 107, 0.4)",t.shadowBlur=8*d,t.shadowOffsetX=0,t.shadowOffsetY=2*d,t.fillStyle="#ffffff",t.font=`600 ${Math.max(16,22*d)}px -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif`,t.textAlign="center",t.textBaseline="middle",t.fillText(U("game.retry"),S/2,j+L/2),t.shadowColor="transparent",t.shadowBlur=0}const xe=m.goals.every(C=>C.current>=C.target);if(A&&!m.isPaused&&!m.isGameOver){const C=Z+A.col*v,G=X+A.row*v,W=Date.now()%1e3,$=.4+Math.sin(W/1e3*Math.PI*2)*.3;t.save(),t.strokeStyle="#667eea",t.lineWidth=Math.max(3,4*d),t.setLineDash([5*d,5*d]),t.strokeRect(C,G,v,v),t.fillStyle=`rgba(102, 126, 234, ${$*.3})`,t.fillRect(C,G,v,v),t.restore()}if(m.isAnimating){const C=Ge(m.board),G=new Set;for(const W of C)for(const $ of W.positions)G.add(`${$.row},${$.col}`);G.forEach(W=>{const[$,w]=W.split(","),_=Number($),j=Number(w);if(!Number.isNaN(_)&&!Number.isNaN(j)&&_>=0&&_<Te&&j>=0&&j<ve){const I=Z+j*v,L=X+_*v,J=Date.now()%1e3,M=.3+Math.sin(J/1e3*Math.PI*2)*.2;t.fillStyle=`rgba(255, 215, 61, ${M})`,t.strokeStyle="#ffd93d",t.lineWidth=Math.max(2,3*d),t.strokeRect(I,L,v,v),t.fillRect(I,L,v,v)}})}if(m.board&&m.board.length>0&&c.current){let C=!1;m.board.forEach((W,$)=>{W&&W.forEach((w,_)=>{if(w){const j=Z+_*v,I=X+$*v;if(V.current&&D.current&&Y.current&&ee.current){const M=D.current,B=Y.current,ce=ee.current;if($===M.row&&_===M.col)if(O.current){const pe=O.current.x-ce.x,Me=O.current.y-ce.y,ne=v,Pe=Math.max(-ne,Math.min(ne,pe)),Ie=Math.max(-ne,Math.min(ne,Me));w.x=j+Pe,w.y=I+Ie}else w.x=j,w.y=I;else if($===B.row&&_===B.col)if(O.current){const pe=O.current.x-ce.x,Me=O.current.y-ce.y,ne=v,Pe=Math.max(-ne,Math.min(ne,-pe)),Ie=Math.max(-ne,Math.min(ne,-Me));w.x=j+Pe,w.y=I+Ie}else w.x=j,w.y=I;else w.x=j,w.y=I}else if(w.targetY!==void 0){C=!0;let M;w.targetY<100?M=X+w.targetY*v:M=w.targetY,(w.y===void 0||w.y===0)&&(w.y=I);const B=M-w.y,ce=.15;Math.abs(B)>1?(w.y+=B*ce,B>0&&(w.y+=1)):(w.y=M,w.targetY=void 0),w.x=j}else if(w.targetX!==void 0){const M=w.targetX-w.x,B=.2;Math.abs(M)>.1?w.x+=M*B:(w.x=w.targetX,w.targetX=void 0),w.y=I}else(w.x===0&&w.y===0&&w.targetX===void 0&&w.targetY===void 0||w.x!==j||w.y!==I)&&(w.x=j,w.y=I);m.selectedGem&&m.selectedGem.row===$&&m.selectedGem.col===_&&(t.fillStyle="rgba(255, 255, 255, 0.3)",t.strokeStyle="rgba(255, 255, 255, 0.8)",t.lineWidth=Math.max(2,3*d),t.strokeRect(j,I,v,v),t.fillRect(j,I,v,v)),Q&&g.current&&(g.current.from.row===$&&g.current.from.col===_||g.current.to.row===$&&g.current.to.col===_)&&(t.fillStyle="rgba(255, 215, 61, 0.4)",t.strokeStyle="#ffd93d",t.lineWidth=Math.max(3,4*d),t.strokeRect(j,I,v,v),t.fillRect(j,I,v,v));let L=1,J=w.scale||1;if(w.isRemoving){let M=b.current.get(w.id);M||(M={alpha:1,scale:1},b.current.set(w.id,M)),M.alpha=Math.max(0,M.alpha-.08),M.scale=Math.max(0,M.scale-.08),L=M.alpha,J=M.scale,w.alpha=L,w.scale=J,b.current.set(w.id,M)}else w.alpha=1,w.scale=1;if(L>0){const M=xe&&!m.isAnimating?L*.3:L;c.current.render(w,M)}if(w.isRemoving&&L>.8&&L<.9&&f.current){const M=w.x+v/2,B=w.y+v/2;f.current.emit(M,B,w.color,15)}}})});const G=y.current;y.current=C,G&&!C&&m.isAnimating&&e==="game"&&!m.isGameOver&&!z.current&&setTimeout(()=>{m.isAnimating&&e==="game"&&!m.isGameOver&&!z.current&&(z.current=!0,He(),setTimeout(()=>{z.current=!1,H.current=""},200))},100)}if(f.current&&(f.current.update(16),f.current.render()),xe&&!m.isAnimating&&!m.isGameOver){const C=mt(m);t.fillStyle="rgba(15, 15, 30, 0.92)",t.fillRect(0,0,S,E);const G=500*d,W=400*d,$=(S-G)/2,w=(E-W)/2,_=28*d;t.save(),t.globalAlpha=.96,t.fillStyle="rgba(26, 26, 46, 0.9)",t.beginPath(),t.roundRect($,w,G,W,_),t.fill(),t.strokeStyle="rgba(78, 205, 196, 0.4)",t.lineWidth=2*d,t.stroke(),t.restore(),t.shadowColor="rgba(78, 205, 196, 0.5)",t.shadowBlur=12*d,t.shadowOffsetX=0,t.shadowOffsetY=0,t.fillStyle="#4ecdc4",t.font=`700 ${Math.max(32,64*d)}px -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif`,t.textAlign="center",t.textBaseline="middle",t.fillText(U("game.stageCleared"),S/2,w+80*d);const j=Math.max(24,48*d),I=j*1.8,L=S/2-I,J=w+160*d;for(let Pe=0;Pe<3;Pe++){const Ie=L+Pe*I;t.shadowColor=Pe<C?"rgba(255, 217, 61, 0.6)":"transparent",t.shadowBlur=Pe<C?12*d:0,t.fillStyle=Pe<C?"#ffd93d":"rgba(102, 102, 102, 0.5)",t.font=`${j}px Arial`,t.textAlign="center",t.textBaseline="middle",t.fillText("‚òÖ",Ie,J)}t.shadowColor="transparent",t.shadowBlur=0,t.fillStyle="rgba(255, 255, 255, 0.9)",t.font=`600 ${Math.max(18,28*d)}px -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif`,t.fillText(`${U("game.score")}: ${m.score.toLocaleString()}`,S/2,w+220*d);const M=S/2-120*d,B=w+280*d,ce=240*d,pe=60*d,Me=16*d,ne=t.createLinearGradient(M,B,M,B+pe);ne.addColorStop(0,"#667eea"),ne.addColorStop(1,"#764ba2"),t.save(),t.beginPath(),t.roundRect(M,B,ce,pe,Me),t.fillStyle=ne,t.fill(),t.strokeStyle="rgba(255, 255, 255, 0.3)",t.lineWidth=2*d,t.stroke(),t.restore(),t.shadowColor="rgba(102, 126, 234, 0.4)",t.shadowBlur=8*d,t.shadowOffsetX=0,t.shadowOffsetY=2*d,t.fillStyle="#ffffff",t.font=`600 ${Math.max(16,22*d)}px -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif`,t.textAlign="center",t.textBaseline="middle",t.fillText(U("game.nextStage"),S/2,B+pe/2),t.shadowColor="transparent",t.shadowBlur=0}},[oe,m,Q,U]),Ee=p.useCallback(()=>{const t=n.current,S=l.current;if(!t||!S)return;const E=window.devicePixelRatio||1,P=t.width/E,d=t.height/E;P===0||d===0||(e==="stageSelect"?et(S,P,d):e==="game"?tt(S,P,d):(S.fillStyle="#1a1a1a",S.fillRect(0,0,P,d)))},[e,et,tt]);p.useEffect(()=>{let t=0;const E=1e3/60,P=pt.subscribe(te=>{}),d=()=>{const te=v=>{v-t>=E&&(Ee(),pt.update(),t=v),h.current=requestAnimationFrame(te)};h.current=requestAnimationFrame(te)};return n.current&&l.current&&(d(),R.info("GameBoard render loop started",{stage:s,screen:e})),()=>{h.current!==null&&(cancelAnimationFrame(h.current),h.current=null),P(),R.debug("GameBoard render loop stopped")}},[Ee,s,e]);const Tt=p.useCallback((t,S)=>{a.current||(a.current=!0,n.current=t,l.current=S,Ee())},[Ee]),xt=p.useCallback((t,S)=>{n.current=t,l.current=S,Ee()},[Ee]);p.useEffect(()=>{if(n.current&&l.current){const t=setTimeout(()=>{Ee()},10);return()=>clearTimeout(t)}},[Ee,e,Re,s,m]),p.useEffect(()=>{if(m.isAnimating&&e==="game"&&!m.isGameOver&&!z.current){const t=JSON.stringify(m.board);if(t!==H.current)return z.current=!0,H.current=t,T.current&&clearTimeout(T.current),T.current=setTimeout(()=>{const E=()=>{y.current?setTimeout(E,50):(He(),setTimeout(()=>{z.current=!1,H.current=""},200))};E()},300),()=>{T.current&&(clearTimeout(T.current),T.current=null)}}else m.isAnimating||(H.current="",z.current=!1)},[m.isAnimating,m.board,He,e,m.isGameOver]),p.useEffect(()=>{if(e!=="game"){ye.current=!1,Se.current=!1;return}const t=m.goals.every(S=>S.current>=S.target);if(!ye.current&&m.isGameOver&&(R.info("Game Over",{stage:m.currentStage,score:m.score,moves:m.moves}),de.playGameOver()),!Se.current&&t&&!m.isGameOver){const S=mt(m);R.info("Stage Cleared",{stage:m.currentStage,score:m.score,moves:m.moves,stars:S}),de.playStageClear();const P=Oe.get("chipPuzzleGame_progress",{fallback:null})||{highestStage:1,stageRecords:{}},d=m.currentStage;d>=P.highestStage&&(P.highestStage=d+1),P.stageRecords||(P.stageRecords={});const te=d.toString(),v=P.stageRecords[te];!v||m.score>v.bestScore?P.stageRecords[te]={stageNumber:d,stars:Math.max((v==null?void 0:v.stars)||0,S),score:m.score,bestScore:m.score,completedAt:new Date().toISOString(),attempts:((v==null?void 0:v.attempts)||0)+1}:P.stageRecords[te]=ke(fe({},v),{stars:Math.max(v.stars,S),attempts:v.attempts+1}),Oe.set("chipPuzzleGame_progress",P)||R.error("Failed to save progress",{stage:m.currentStage})}ye.current=m.isGameOver,Se.current=t},[m.isGameOver,m.goals,m.score,m.currentStage,e]);const We=p.useCallback(t=>{if(K.current){K.current=!1;return}const S=n.current;if(!S)return;const E=S.getBoundingClientRect(),P=t.clientX-E.left,d=t.clientY-E.top,te=window.devicePixelRatio||1,v=S.width/te,ve=S.height/te;if(e==="stageSelect"){if(!r)return;const k=v/1200,Ce=120,Z=40,X=20*k,re=Ce*k,ie=Z*k,me=v-re-X,le=X;if(P>=me&&P<=me+re&&d>=le&&d<=le+ie){if(Q)ue(!1),g.current=null;else{const B=Je(m.board);B&&(g.current=B,ue(!0),setTimeout(()=>{ue(!1),g.current=null},3e3))}return}const q=50,ge=1e3,se=Math.ceil(ge/q),be=30*k,we=80*k,C=ve-60*k+20*k,G=10*k;if(N>1){const B=v/2-we-G/2;if(P>=B&&P<=B+we&&d>=C&&d<=C+be){ae(N-1),de.playClick();return}}if(N<se){const B=v/2+G/2;if(P>=B&&P<=B+we&&d>=C&&d<=C+be){ae(N+1),de.playClick();return}}const W=8,$=60,w=15,_=$*k,j=w*k,I=(v-(W*_+(W-1)*j))/2,L=100*k,J=Math.floor((P-I)/(_+j)),M=Math.floor((d-L)/(_+j));if(J>=0&&J<W&&M>=0){const ce=(N-1)*q+1+M*W+J;ce<=Re&&ce<=ge&&r(ce)}}else if(e==="game"){const k=v/1200;if(m.goals.every(M=>M.current>=M.target)&&!m.isAnimating&&!m.isGameOver){const M=v/2-100*k,B=ve/2+80*k,ce=200*k,pe=50*k;if(P>=M&&P<=M+ce&&d>=B&&d<=B+pe){if(r){const Me=s+1;r(Me)}de.playClick();return}return}if(m.isGameOver){const M=v/2-100*k,B=ve/2+100*k,ce=200*k,pe=50*k;if(P>=M&&P<=M+ce&&d>=B&&d<=B+pe){r&&r(s),de.playClick();return}return}if(m.isPaused){$e(),de.playClick();return}const Z=120,X=40,re=20*k,ie=10*k,me=Z*k,le=X*k,q=Z*k,ge=X*k,se=v-me-re,be=re,we=se-q-ie,xe=re;if(P>=we&&P<=we+q&&d>=xe&&d<=xe+ge){$e(),de.playClick();return}if(P>=se&&P<=se+me&&d>=be&&d<=be+le){if(Q)ue(!1),g.current=null;else{const M=Je(m.board);M&&(g.current=M,ue(!0),setTimeout(()=>{ue(!1),g.current=null},3e3))}de.playClick();return}if(m.isPaused)return;const G=(oe.cellSize||70)*k,W=oe.gridCols||9,$=oe.gridRows||9,w=G*W,_=G*$,j=(v-w)/2,I=(ve-_)/2,L=Math.floor((P-j)/G),J=Math.floor((d-I)/G);L>=0&&L<W&&J>=0&&J<$&&m.board[J]&&m.board[J][L]&&(m.selectedGem?Le(m.selectedGem,{row:J,col:L}):Ae(J,L),de.playClick())}},[e,r,Re,oe,m,Ae,Le,Q,$e]),Ve=p.useCallback(t=>{const S=n.current;if(!S||e!=="game"||m.isPaused)return;const E=S.getBoundingClientRect(),P=t.clientX-E.left,d=t.clientY-E.top,te=window.devicePixelRatio||1,v=S.width/te,ve=S.height/te,k=v/1200,Z=(oe.cellSize||50)*k,X=oe.gridCols||9,re=oe.gridRows||9,ie=Z*X,me=Z*re,le=(v-ie)/2,q=(ve-me)/2,ge=Math.floor((P-le)/Z),se=Math.floor((d-q)/Z);ge>=0&&ge<X&&se>=0&&se<re&&m.board[se]&&m.board[se][ge]&&(D.current={row:se,col:ge},ee.current={x:P,y:d},V.current=!0)},[e,oe,m.board,m.isPaused]),Ue=p.useCallback(t=>{const S=n.current;if(!S||e!=="game"||m.isPaused||!V.current||!D.current||!ee.current)return;const E=S.getBoundingClientRect(),P=t.clientX-E.left,d=t.clientY-E.top,te=window.devicePixelRatio||1,Te=S.width/te/1200,k=oe.gridCols||9,Ce=oe.gridRows||9,Z=ee.current,X=P-Z.x,re=d-Z.y,ie=Math.sqrt(X*X+re*re),me=10*Te;if(ie<me){O.current={x:P,y:d},Y.current=null;return}const le=D.current;let q={row:le.row,col:le.col};if(Math.abs(X)>Math.abs(re)?X>0?q.col+=1:q.col-=1:re>0?q.row+=1:q.row-=1,q.col<0||q.col>=k||q.row<0||q.row>=Ce){V.current=!1,D.current=null,ee.current=null,Y.current=null,O.current=null;return}O.current={x:P,y:d},Y.current=q},[e,oe,m.isPaused]),ze=p.useCallback(()=>{if(V.current&&D.current&&Y.current){const t=D.current,S=Y.current,E=Math.abs(t.row-S.row),P=Math.abs(t.col-S.col);(E===1&&P===0||E===0&&P===1)&&(Le(t,S),de.playClick(),K.current=!0)}V.current=!1,D.current=null,ee.current=null,Y.current=null,O.current=null},[Le]);p.useEffect(()=>{const t=n.current;if(t)return t.addEventListener("click",We),()=>{t.removeEventListener("click",We)}},[We]),p.useEffect(()=>{const t=n.current;if(t)return t.addEventListener("pointerdown",Ve),t.addEventListener("pointermove",Ue),t.addEventListener("pointerup",ze),t.addEventListener("pointerleave",ze),t.addEventListener("pointercancel",ze),()=>{t.removeEventListener("pointerdown",Ve),t.removeEventListener("pointermove",Ue),t.removeEventListener("pointerup",ze),t.removeEventListener("pointerleave",ze),t.removeEventListener("pointercancel",ze)}},[Ve,Ue,ze]);const Ye=p.useCallback(t=>{if(e!=="game"||m.isPaused||m.isAnimating)return;const S=oe.gridRows||9,E=oe.gridCols||9;if(!A){he({row:0,col:0});return}let P=A.row,d=A.col;switch(t.key){case"ArrowUp":t.preventDefault(),P=Math.max(0,A.row-1),he({row:P,col:A.col});break;case"ArrowDown":t.preventDefault(),P=Math.min(S-1,A.row+1),he({row:P,col:A.col});break;case"ArrowLeft":t.preventDefault(),d=Math.max(0,A.col-1),he({row:A.row,col:d});break;case"ArrowRight":t.preventDefault(),d=Math.min(E-1,A.col+1),he({row:A.row,col:d});break;case" ":case"Enter":t.preventDefault(),m.board[A.row]&&m.board[A.row][A.col]&&Ae(A.row,A.col);break;case"Escape":t.preventDefault(),$e();break;case"h":case"H":if(t.preventDefault(),Q)ue(!1),g.current=null;else{const te=Je(m.board);te&&(g.current=te,ue(!0),setTimeout(()=>{ue(!1),g.current=null},3e3))}break}},[e,m.isPaused,m.isAnimating,m.board,A,oe.gridRows,oe.gridCols,Ae,$e,Q]);return p.useEffect(()=>{const t=n.current;if(t)return t.addEventListener("keydown",Ye),()=>{t.removeEventListener("keydown",Ye)}},[Ye]),p.useEffect(()=>{e!=="game"&&he(null)},[e,m.board]),p.useEffect(()=>{typeof window!="undefined"&&Oe.remove("chipPuzzleGame_orientationPreference",{silent:!0})},[]),u.jsx("div",{className:"game-board",children:u.jsx(ro,{config:oe,onReady:Tt,onResize:xt})})},Lo=({title:s,description:e,keywords:o,image:r,type:a="website",url:n="https://chipgames.github.io/ChipPuzzleGame/",noindex:l=!1})=>{const{language:c}=Be(),{t:i}=Be(),f=typeof window!="undefined"?window.location.pathname+window.location.search:"",h=f.includes("screen=guide")||n.includes("screen=guide"),b=f.includes("screen=help")||n.includes("screen=help"),g=f.includes("screen=about")||n.includes("screen=about");let y,T,H;h?(y=i("seo.guideTitle")||i("seo.title"),T=i("seo.guideDescription")||i("seo.description"),H=i("seo.guideKeywords")||i("seo.keywords")):b?(y=i("seo.helpTitle")||i("seo.title"),T=i("seo.helpDescription")||i("seo.description"),H=i("seo.helpKeywords")||i("seo.keywords")):g?(y=i("seo.aboutTitle")||i("seo.title"),T=i("seo.aboutDescription")||i("seo.description"),H=i("seo.aboutKeywords")||i("seo.keywords")):(y=i("seo.title")||"Îß§Ïπ≠ ÌçºÏ¶ê Í≤åÏûÑ - CHIP GAMES",T=i("seo.description")||"Î¨¥Î£å Ïò®ÎùºÏù∏ Îß§Ïπ≠ ÌçºÏ¶ê Í≤åÏûÑ. 1000Í∞úÏùò ÎèÑÏ†ÑÏ†ÅÏù∏ Ïä§ÌÖåÏù¥ÏßÄÎ•º ÌîåÎ†àÏù¥ÌïòÏÑ∏Ïöî! Îã§ÏñëÌïú ÏÉâÏÉÅÏùò Ï†¨ÏùÑ Îß§Ïπ≠ÌïòÏó¨ Î™©ÌëúÎ•º Îã¨ÏÑ±ÌïòÎäî Ïû¨ÎØ∏ÏûàÎäî ÌçºÏ¶ê Í≤åÏûÑÏûÖÎãàÎã§.",H=i("seo.keywords")||"Îß§Ïπ≠Í≤åÏûÑ, ÌçºÏ¶êÍ≤åÏûÑ, Î¨¥Î£åÍ≤åÏûÑ, Ïò®ÎùºÏù∏Í≤åÏûÑ, ÌçºÏ¶ê, Îß§Ïπ≠3, Ï∫îÎîîÌÅ¨Îü¨Ïãú, Í≤åÏûÑ, Î∏åÎùºÏö∞Ï†ÄÍ≤åÏûÑ, HTML5Í≤åÏûÑ");const z="https://chipgames.github.io/ChipPuzzleGame/ChipGames_Logo.png",D=s||y,ee=e||T,Y=o||H,O=r||z,V="https://chipgames.github.io/ChipPuzzleGame/",K=c!=="ko"?`?lang=${c}`:"",ye={"@context":"https://schema.org","@type":"Organization",name:"CHIP GAMES",url:"https://chipgames.github.io",logo:"https://chipgames.github.io/ChipPuzzleGame/ChipGames_Logo.png",sameAs:[]},Se={"@context":"https://schema.org","@type":"VideoGame",name:D,description:ee,image:O,url:n,applicationCategory:"Game",operatingSystem:"Web Browser",gamePlatform:"Web Browser",offers:{"@type":"Offer",price:"0",priceCurrency:"KRW"},aggregateRating:{"@type":"AggregateRating",ratingValue:"4.5",ratingCount:"100",bestRating:"5",worstRating:"1"},publisher:{"@type":"Organization",name:"CHIP GAMES",url:"https://chipgames.github.io"},genre:"Puzzle Game",gameItem:{"@type":"Thing",name:"Match Puzzle Game",description:"Match colorful gems to complete challenging stages"},inLanguage:c||"ko",datePublished:"2025-01-01",dateModified:new Date().toISOString().split("T")[0]},Q=[{"@type":"ListItem",position:1,name:c==="ko"?"Ìôà":c==="en"?"Home":c==="ja"?"„Éõ„Éº„É†":"È¶ñÈ°µ",item:`${V}${K}`}];h?Q.push({"@type":"ListItem",position:2,name:i("guide.title")||"Í≤åÏûÑ Í∞ÄÏù¥Îìú",item:`${V}?screen=guide${K}`}):b?Q.push({"@type":"ListItem",position:2,name:i("help.title")||"ÎèÑÏõÄÎßê",item:`${V}?screen=help${K}`}):g&&Q.push({"@type":"ListItem",position:2,name:i("about.title")||"Í≤åÏûÑ ÏÜåÍ∞ú",item:`${V}?screen=about${K}`});const ue={"@context":"https://schema.org","@type":"BreadcrumbList",itemListElement:Q},U=b?{"@context":"https://schema.org","@type":"FAQPage",mainEntity:[{"@type":"Question",name:i("help.section7Title")||"ÏûêÏ£º Î¨ªÎäî ÏßàÎ¨∏",acceptedAnswer:{"@type":"Answer",text:i("help.section7Content")||""}}]}:null,x=[ye,{"@context":"https://schema.org","@type":"WebSite",name:"CHIP GAMES - Match Puzzle Game",url:V,publisher:{"@type":"Organization",name:"CHIP GAMES"},inLanguage:[c||"ko","en","ja","zh"]}];return!h&&!b&&!g&&x.push(Se),x.push(ue),U&&x.push(U),u.jsxs(Ot,{children:[u.jsx("title",{children:D}),u.jsx("meta",{name:"description",content:ee}),u.jsx("meta",{name:"keywords",content:Y}),u.jsx("meta",{name:"theme-color",content:"#667eea"}),u.jsx("meta",{name:"msapplication-TileColor",content:"#667eea"}),l&&u.jsx("meta",{name:"robots",content:"noindex, nofollow"}),u.jsx("link",{rel:"canonical",href:n}),u.jsx("meta",{property:"og:title",content:D}),u.jsx("meta",{property:"og:description",content:ee}),u.jsx("meta",{property:"og:image",content:O}),u.jsx("meta",{property:"og:image:secure_url",content:O}),u.jsx("meta",{property:"og:image:width",content:"1200"}),u.jsx("meta",{property:"og:image:height",content:"630"}),u.jsx("meta",{property:"og:image:alt",content:D}),u.jsx("meta",{property:"og:image:type",content:"image/png"}),u.jsx("meta",{property:"og:type",content:a}),u.jsx("meta",{property:"og:url",content:n}),u.jsx("meta",{property:"og:site_name",content:"CHIP GAMES"}),u.jsx("meta",{property:"og:locale",content:c==="ko"?"ko_KR":c==="en"?"en_US":c==="ja"?"ja_JP":"zh_CN"}),u.jsx("meta",{property:"og:updated_time",content:new Date().toISOString()}),u.jsx("meta",{name:"twitter:card",content:"summary_large_image"}),u.jsx("meta",{name:"twitter:title",content:D}),u.jsx("meta",{name:"twitter:description",content:ee}),u.jsx("meta",{name:"twitter:image",content:O}),u.jsx("meta",{name:"twitter:image:alt",content:D}),u.jsx("meta",{name:"twitter:site",content:"@CHIPGAMES"}),u.jsx("meta",{name:"twitter:creator",content:"@CHIPGAMES"}),u.jsx("link",{rel:"alternate",hrefLang:"ko",href:`${n}?lang=ko`}),u.jsx("link",{rel:"alternate",hrefLang:"en",href:`${n}?lang=en`}),u.jsx("link",{rel:"alternate",hrefLang:"ja",href:`${n}?lang=ja`}),u.jsx("link",{rel:"alternate",hrefLang:"zh",href:`${n}?lang=zh`}),u.jsx("link",{rel:"alternate",hrefLang:"x-default",href:n}),u.jsx("meta",{httpEquiv:"Content-Security-Policy",content:"default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://pagead2.googlesyndication.com; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self' https://pagead2.googlesyndication.com; frame-src 'self' https://googleads.g.doubleclick.net https://tpc.googlesyndication.com; object-src 'none'; base-uri 'self'; form-action 'self';"}),x.map((N,ae)=>u.jsx("script",{type:"application/ld+json",children:JSON.stringify(N)},ae))]})};function Qe(){try{}catch(s){}return window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"||window.location.hostname.includes("localhost")}function Pt(){window.adsbygoogle&&Array.isArray(window.adsbygoogle)||(window.adsbygoogle=window.adsbygoogle||[])}function zo(){return!(window.adsbygoogle&&Array.isArray(window.adsbygoogle)&&window.adsbygoogle.some(s=>s.enable_page_level_ads))}function yt(){document.querySelectorAll('iframe[src*="googlesyndication.com"], iframe[src*="doubleclick.net"]').forEach(e=>{try{const o=e;if(o.contentDocument){const r=o.contentDocument.body;r&&r.getAttribute("aria-hidden")==="true"&&r.removeAttribute("aria-hidden")}}catch(o){}})}function Bo(){if(!Qe()&&(Pt(),!!zo()))try{window.adsbygoogle&&Array.isArray(window.adsbygoogle)&&window.adsbygoogle.push({google_ad_client:"ca-pub-2533613198240039",enable_page_level_ads:!0})}catch(s){Qe()}}function Oo(){if(Qe())return;setTimeout(yt,2e3),new MutationObserver(e=>{e.forEach(o=>{o.type==="childList"&&o.addedNodes.forEach(r=>{r.nodeType===1&&r.tagName==="IFRAME"&&setTimeout(yt,1e3)})})}).observe(document.body,{childList:!0,subtree:!0})}function Ne(){try{}catch(s){}return window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"||window.location.hostname.includes("localhost")}function _o(s){if(!(typeof window=="undefined"||!("PerformanceObserver"in window)))try{const e=new PerformanceObserver(o=>{const r=o.getEntries(),a=r[r.length-1];if(a){const n=a.renderTime||a.loadTime||0,l=n<2500?"good":n<4e3?"needs-improvement":"poor";s({name:"LCP",value:n,id:`lcp-${Date.now()}`,delta:n,rating:l,timestamp:performance.now(),entries:[a]}),e.disconnect()}});e.observe({entryTypes:["largest-contentful-paint"]})}catch(e){Ne()&&R.warn("LCP measurement failed",{error:e})}}function No(s){if(!(typeof window=="undefined"||!("PerformanceObserver"in window)))try{const e=new PerformanceObserver(o=>{const a=o.getEntries()[0];if(a){const n=a.processingStart-a.startTime,l=n<100?"good":n<300?"needs-improvement":"poor";s({name:"FID",value:n,id:`fid-${Date.now()}`,delta:n,rating:l,timestamp:performance.now(),entries:[a]}),e.disconnect()}});e.observe({entryTypes:["first-input"]})}catch(e){Ne()&&R.warn("FID measurement failed",{error:e})}}function $o(s){if(!(typeof window=="undefined"||!("PerformanceObserver"in window)))try{let e=0;new PerformanceObserver(a=>{const n=a.getEntries();for(const l of n)l.hadRecentInput||(e+=l.value);if(n.length>0){const l=e<.1?"good":e<.25?"needs-improvement":"poor";s({name:"CLS",value:e,id:`cls-${Date.now()}`,delta:e,rating:l,timestamp:performance.now(),entries:n})}}).observe({entryTypes:["layout-shift"]});const r=()=>{if(document.visibilityState==="hidden"){const a=e<.1?"good":e<.25?"needs-improvement":"poor";s({name:"CLS",value:e,id:`cls-final-${Date.now()}`,delta:e,rating:a,timestamp:performance.now()})}};document.addEventListener("visibilitychange",r)}catch(e){Ne()&&R.warn("CLS measurement failed",{error:e})}}function Io(s){if(!(typeof window=="undefined"||!("PerformanceObserver"in window)))try{const e=new PerformanceObserver(o=>{const a=o.getEntries()[0];if(a){const n=a.startTime,l=n<1800?"good":n<3e3?"needs-improvement":"poor";s({name:"FCP",value:n,id:`fcp-${Date.now()}`,delta:n,rating:l,timestamp:performance.now(),entries:[a]}),e.disconnect()}});e.observe({entryTypes:["paint"]})}catch(e){Ne()&&R.warn("FCP measurement failed",{error:e})}}function Do(s){if(!(typeof window=="undefined"||!("performance"in window)))try{const e=performance.getEntriesByType("navigation")[0];if(e){const o=e.responseStart-e.requestStart,r=o<800?"good":o<1800?"needs-improvement":"poor";s({name:"TTFB",value:o,id:`ttfb-${Date.now()}`,delta:o,rating:r,timestamp:performance.now(),entries:[e]})}}catch(e){Ne()&&R.warn("TTFB measurement failed",{error:e})}}function Fo(s){typeof window!="undefined"&&(_o(s),No(s),$o(s),Io(s),Do(s))}function Ho(s){Ze.addWebVital(s),Ne()?R.info(`Web Vital: ${s.name}`,{value:s.value,rating:s.rating,id:s.id,timestamp:s.timestamp}):s.rating==="poor"&&R.warn(`Poor Web Vital: ${s.name}`,{value:s.value,rating:s.rating,id:s.id})}function Wo(){try{}catch(s){}return window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"||window.location.hostname.includes("localhost")}function Vo(){if(typeof window=="undefined"||!("serviceWorker"in navigator)){Wo()&&R.warn("Service Worker is not supported in this browser");return}window.addEventListener("load",()=>{const s="/ChipPuzzleGame/sw.js";navigator.serviceWorker.register(s,{scope:"/ChipPuzzleGame/"}).then(e=>{R.info("Service Worker registered successfully",{scope:e.scope}),e.addEventListener("updatefound",()=>{const o=e.installing;o&&o.addEventListener("statechange",()=>{o.state==="installed"&&navigator.serviceWorker.controller&&(R.info("New Service Worker version available"),confirm("ÏÉà Î≤ÑÏ†ÑÏù¥ ÏÇ¨Ïö© Í∞ÄÎä•Ìï©ÎãàÎã§. ÏóÖÎç∞Ïù¥Ìä∏ÌïòÏãúÍ≤†ÏäµÎãàÍπå?")&&(o.postMessage({type:"SKIP_WAITING"}),window.location.reload()))})})}).catch(e=>{R.error("Service Worker registration failed",{error:e})})}),navigator.serviceWorker.addEventListener("controllerchange",()=>{R.info("Service Worker controller changed"),window.location.reload()})}const Uo=p.lazy(()=>je(()=>import("./GuideScreen-1.1.0-f1d2de4e.js"),["assets/GuideScreen-1.1.0-f1d2de4e.js","assets/vendor-1.1.0-1f763956.js","assets/helmet-1.1.0-341783ac.js","assets/GuideScreen-1.1.0-c920bc31.css"])),Yo=p.lazy(()=>je(()=>import("./HelpScreen-1.1.0-a7069120.js"),["assets/HelpScreen-1.1.0-a7069120.js","assets/vendor-1.1.0-1f763956.js","assets/helmet-1.1.0-341783ac.js","assets/HelpScreen-1.1.0-3a04b69e.css"])),Xo=p.lazy(()=>je(()=>import("./AboutScreen-1.1.0-010ed7f4.js"),["assets/AboutScreen-1.1.0-010ed7f4.js","assets/vendor-1.1.0-1f763956.js","assets/helmet-1.1.0-341783ac.js","assets/AboutScreen-1.1.0-709fc7ba.css"])),qo=()=>{const[s,e]=p.useState("stageSelect"),[o,r]=p.useState(null);p.useEffect(()=>{let c=!1;try{c=!1}catch(i){}c||(c=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"||window.location.hostname.includes("localhost")),c||(Pt(),Bo(),Oo())},[]),p.useEffect(()=>{Fo(Ho);const c=()=>{je(()=>Promise.resolve().then(()=>Eo),void 0).then(({performanceAnalytics:i})=>{i.logReport()})};return window.addEventListener("beforeunload",c),()=>{window.removeEventListener("beforeunload",c)}},[]),p.useEffect(()=>{Vo()},[]);const a=c=>{e(c)},n=c=>{r(c),e("game")},l=()=>{const c="https://chipgames.github.io/ChipPuzzleGame/",i=new URLSearchParams(window.location.search).get("lang")||"ko",f=i!=="ko"?`?lang=${i}`:"";switch(s){case"guide":return{title:void 0,description:void 0,keywords:void 0,url:`${c}?screen=guide${f}`,type:"article"};case"help":return{title:void 0,description:void 0,keywords:void 0,url:`${c}?screen=help${f}`,type:"article"};case"about":return{title:void 0,description:void 0,keywords:void 0,url:`${c}?screen=about${f}`,type:"article"};default:return{title:void 0,description:void 0,keywords:void 0,url:`${c}${f}`,type:"website"}}};return u.jsxs(Yt,{children:[u.jsx(Lo,fe({},l())),u.jsxs("div",{className:"app-container",children:[u.jsx(Ct,{onNavigate:a,currentScreen:s}),u.jsx(oo,{children:s==="guide"?u.jsx(p.Suspense,{fallback:u.jsx("div",{style:{padding:"20px",textAlign:"center"},children:"Î°úÎî© Ï§ë..."}),children:u.jsx(Uo,{onNavigate:a})}):s==="help"?u.jsx(p.Suspense,{fallback:u.jsx("div",{style:{padding:"20px",textAlign:"center"},children:"Î°úÎî© Ï§ë..."}),children:u.jsx(Yo,{onNavigate:a})}):s==="about"?u.jsx(p.Suspense,{fallback:u.jsx("div",{style:{padding:"20px",textAlign:"center"},children:"Î°úÎî© Ï§ë..."}),children:u.jsx(Xo,{onNavigate:a})}):u.jsx(Ao,{stageNumber:o||1,currentScreen:s,onNavigate:a,onStartStage:n})}),u.jsx(Rt,{})]})]})};Ke.createRoot(document.getElementById("root")).render(u.jsx(Bt.StrictMode,{children:u.jsx(_t,{children:u.jsx(qo,{})})}));export{u as j,Be as u};
